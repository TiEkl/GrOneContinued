<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" revision="0.9.5">

<unit revision="0.9.5" language="Java" filename="server\RepoHandler\repository\Asteroids\src\Explosion.java" hash="704b01580a75eda43a676bd7d909f534c95722a2"><class><specifier>public</specifier> class <name>Explosion</name> <block>{
}</block></class>
</unit>

<unit revision="0.9.5" language="Java" filename="server\RepoHandler\repository\Asteroids\src\Graphics.java" hash="1891207d790172ab84caed454a1ab96f75806150"><class><specifier>public</specifier> class <name>Graphics</name> <block>{
}</block></class>
</unit>

<unit revision="0.9.5" language="Java" filename="server\RepoHandler\repository\Asteroids\src\Missile.java" hash="b7c94e83556382897e73099b70e63fdaec766846"><class><specifier>public</specifier> class <name>Missile</name> <block>{
}</block></class>
</unit>

<unit revision="0.9.5" language="Java" filename="server\RepoHandler\repository\Asteroids\src\Photons.java" hash="bec54b20790cd04b7baae88bf26a14808d0e1e40"><class><specifier>public</specifier> class <name>Photons</name> <block>{
}</block></class>
</unit>

<unit revision="0.9.5" language="Java" filename="server\RepoHandler\repository\Asteroids\src\Asteroid.java" hash="7c7a9b85e72ffb26e84f96179951d74f00da709e"><import>import <name><name>java</name><operator>.</operator><name>awt</name><operator>.</operator><name>*</name></name>;</import>

<class><specifier>public</specifier> class <name>Asteroid</name> <block>{

    <decl_stmt><decl><specifier>private</specifier> <type><name>int</name></type> <name>i</name></decl>, <decl><type ref="prev"/><name>j</name></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>private</specifier> <type><name>int</name></type> <name>s</name></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>private</specifier> <type><name>double</name></type> <name>theta</name></decl>, <decl><type ref="prev"/><name>r</name></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>private</specifier> <type><name>int</name></type> <name>x</name></decl>, <decl><type ref="prev"/><name>y</name></decl>;</decl_stmt>

    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>DELAY</name> <init>= <expr><literal type="number">20</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>FPS</name>   <init>= <expr><call><name><name>Math</name><operator>.</operator><name>round</name></name><argument_list>(<argument><expr><literal type="number">1000</literal> <operator>/</operator> <name>DELAY</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MAX_ROCKS</name> <init>=  <expr><literal type="number">8</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MIN_ROCK_SIDES</name> <init>=   <expr><literal type="number">6</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MAX_ROCK_SIDES</name> <init>=  <expr><literal type="number">16</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MIN_ROCK_SIZE</name>  <init>=  <expr><literal type="number">20</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MAX_ROCK_SIZE</name>  <init>=  <expr><literal type="number">40</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>MIN_ROCK_SPEED</name> <init>=  <expr><literal type="number">40.0</literal> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>MAX_ROCK_SPEED</name> <init>= <expr><literal type="number">240.0</literal> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>MAX_ROCK_SPIN</name>  <init>= <expr><name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name><name>AsteroidsSprite</name><index>[]</index></name></type> <name>asteroids</name>  <init>= <expr><operator>new</operator> <name><name>AsteroidsSprite</name><index>[<expr><name>MAX_ROCKS</name></expr>]</index></name></expr></init></decl>;</decl_stmt>

    <decl_stmt><decl><type><name><name>boolean</name><index>[]</index></name></type> <name>asteroidIsSmall</name> <init>= <expr><operator>new</operator> <name><name>boolean</name><index>[<expr><name>MAX_ROCKS</name></expr>]</index></name></expr></init></decl>;</decl_stmt>    <comment type="line">// Asteroid size flag.</comment>
    <decl_stmt><decl><type><name>int</name></type>       <name>asteroidsCounter</name></decl>;</decl_stmt>                            <comment type="line">// Break-time counter.</comment>
    <decl_stmt><decl><type><name>double</name></type>    <name>asteroidsSpeed</name></decl>;</decl_stmt>                              <comment type="line">// Asteroid speed.</comment>
    <decl_stmt><decl><type><name>int</name></type>       <name>asteroidsLeft</name></decl>;</decl_stmt>                               <comment type="line">// Number of active asteroids.</comment>

    <constructor><specifier>public</specifier> <name>Asteroid</name><parameter_list>(<parameter><decl><type><name>int</name></type> <name>i</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>j</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>s</name></decl></parameter>, <parameter><decl><type><name>double</name></type> <name>theta</name></decl></parameter>, <parameter><decl><type><name>double</name></type> <name>r</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>x</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>y</name></decl></parameter>)</parameter_list> <block>{
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>i</name></name> <operator>=</operator> <name>i</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>j</name></name> <operator>=</operator> <name>j</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>s</name></name> <operator>=</operator> <name>s</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>theta</name></name> <operator>=</operator> <name>theta</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>r</name></name> <operator>=</operator> <name>r</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>x</name></name> <operator>=</operator> <name>x</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>y</name></name> <operator>=</operator> <name>y</name></expr>;</expr_stmt>
    }</block></constructor>

    <function><specifier>public</specifier> <type><name>void</name></type> <name>giveShape</name><parameter_list>()</parameter_list> <block>{
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>shape</name> <operator>=</operator> <operator>new</operator> <call><name>Polygon</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>s</name> <operator>=</operator> <name>MIN_ROCK_SIDES</name> <operator>+</operator> <call>(<name>int</name>) <argument_list>(<argument><expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <operator>(</operator><name>MAX_ROCK_SIDES</name> <operator>-</operator> <name>MIN_ROCK_SIDES</name><operator>)</operator></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <for>for <control>(<init><expr><name>j</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>j</name> <operator>&lt;</operator> <name>s</name></expr>;</condition> <incr><expr><name>j</name> <operator>++</operator></expr></incr>)</control> <block>{
            <expr_stmt><expr><name>theta</name> <operator>=</operator> <literal type="number">2</literal> <operator>*</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>/</operator> <name>s</name> <operator>*</operator> <name>j</name></expr>;</expr_stmt>
            <expr_stmt><expr><name>r</name> <operator>=</operator> <name>MIN_ROCK_SIZE</name> <operator>+</operator> <call>(<name>int</name>) <argument_list>(<argument><expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <operator>(</operator><name>MAX_ROCK_SIZE</name> <operator>-</operator> <name>MIN_ROCK_SIZE</name><operator>)</operator></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>x</name> <operator>=</operator> <operator>(</operator><name>int</name><operator>)</operator> <operator>-</operator><call><name><name>Math</name><operator>.</operator><name>round</name></name><argument_list>(<argument><expr><name>r</name> <operator>*</operator> <call><name><name>Math</name><operator>.</operator><name>sin</name></name><argument_list>(<argument><expr><name>theta</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>y</name> <operator>=</operator> <operator>(</operator><name>int</name><operator>)</operator>  <call><name><name>Math</name><operator>.</operator><name>round</name></name><argument_list>(<argument><expr><name>r</name> <operator>*</operator> <call><name><name>Math</name><operator>.</operator><name>cos</name></name><argument_list>(<argument><expr><name>theta</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><name>x</name></expr></argument>, <argument><expr><name>y</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></for>
    }</block></function>

    <function><specifier>public</specifier> <type><name>void</name></type> <name>makeSpin</name><parameter_list>()</parameter_list> <block>{
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>angle</name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaAngle</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <literal type="number">2</literal> <operator>*</operator> <name>MAX_ROCK_SPIN</name> <operator>-</operator> <name>MAX_ROCK_SPIN</name></expr>;</expr_stmt>
    }</block></function>

    <function><specifier>public</specifier> <type><name>void</name></type> <name>place</name><parameter_list>()</parameter_list> <block>{
        <if>if <condition>(<expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>&lt;</operator> <literal type="number">0.5</literal></expr>)</condition><then> <block>{
            <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>x</name> <operator>=</operator> <operator>-</operator><name><name>AsteroidsSprite</name><operator>.</operator><name>width</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt>
            <if>if <condition>(<expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>&lt;</operator> <literal type="number">0.5</literal></expr>)</condition><then>
                <block type="pseudo"><expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>x</name> <operator>=</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>width</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt></block></then></if>
            <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>y</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>height</name></name></expr>;</expr_stmt>
        }</block></then>
        <else>else <block>{
            <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>x</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>width</name></name></expr>;</expr_stmt>
            <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>y</name> <operator>=</operator> <operator>-</operator><name><name>AsteroidsSprite</name><operator>.</operator><name>height</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt>
            <if>if <condition>(<expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>&lt;</operator> <literal type="number">0.5</literal></expr>)</condition><then>
                <block type="pseudo"><expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>y</name> <operator>=</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>height</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt></block></then></if>
        }</block></else></if>
    }</block></function>

    <function><specifier>public</specifier> <type><name>void</name></type> <name>giveRandomMovement</name><parameter_list>()</parameter_list><block>{
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaX</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <name>asteroidsSpeed</name></expr>;</expr_stmt>
        <if>if <condition>(<expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>&lt;</operator> <literal type="number">0.5</literal></expr>)</condition><then>
            <block type="pseudo"><expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaX</name> <operator>=</operator> <operator>-</operator><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaX</name></expr>;</expr_stmt></block></then></if>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaY</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <name>asteroidsSpeed</name></expr>;</expr_stmt>
        <if>if <condition>(<expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>&lt;</operator> <literal type="number">0.5</literal></expr>)</condition><then>
            <block type="pseudo"><expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaY</name> <operator>=</operator> <operator>-</operator><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaY</name></expr>;</expr_stmt></block></then></if>

        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name>render</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroidIsSmall</name><index>[<expr><name>i</name></expr>]</index></name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
    }</block></function>

    <comment type="block">/*public void update(){
        asteroidsCounter = STORM_PAUSE;
        asteroidsLeft = MAX_ROCKS;
        if (asteroidsSpeed &lt; MAX_ROCK_SPEED)
            asteroidsSpeed += 0.5;
    }*/</comment>

}</block></class>
</unit>

<unit revision="0.9.5" language="Java" filename="server\RepoHandler\repository\Asteroids\src\Ship.java" hash="2b2ce38a6ad794ebe51c61ff4d7131627d21ffbb"><class><specifier>public</specifier> class <name>Ship</name> <block>{

    <decl_stmt><decl><type><name>boolean</name></type> <name>isActive</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>double</name></type> <name>angle</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>double</name></type> <name>deltaAngle</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>double</name></type> <name>x</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>double</name></type> <name>y</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>double</name></type> <name>deltaX</name> <init>= <expr><literal type="number">0.0</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>double</name></type> <name>deltaY</name> <init>= <expr><literal type="number">0.0</literal></expr></init></decl>;</decl_stmt>

    <decl_stmt><decl><type><name>boolean</name></type> <name>left</name>  <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>boolean</name></type> <name>right</name> <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>boolean</name></type> <name>up</name>    <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>boolean</name></type> <name>down</name>  <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>

    <decl_stmt><decl><type><name>Game</name></type> <name>game</name> <init>= <expr><operator>new</operator> <call><name>Game</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>

    <decl_stmt><decl><type><name>AsteroidsSprite</name></type>   <name>fwdThruster</name></decl>, <decl><type ref="prev"/><name>revThruster</name></decl>;</decl_stmt>

    <comment type="block">/*public Ship(){
        isActive = true;
        angle = 0.0;
        deltaAngle = 0.0;
        x = 0.0;
        y = 0.0;
        deltaX = 0.0;
        deltaY = 0.0;
    }*/</comment>

    <function><specifier>public</specifier> <type><name>void</name></type> <name>initShip</name><parameter_list>()</parameter_list> <block>{

        <comment type="line">// Reset the ship sprite at the center of the screen.</comment>

        <expr_stmt><expr><name>isActive</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name>angle</name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name>deltaAngle</name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name>x</name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name>y</name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name>deltaX</name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name>deltaY</name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>render</name><argument_list>()</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// Initialize thruster sprites.</comment>

        <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>x</name></name> <operator>=</operator> <name>x</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>y</name></name> <operator>=</operator> <name>y</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <name>angle</name></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>fwdThruster</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>x</name></name> <operator>=</operator> <name>x</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>y</name></name> <operator>=</operator> <name>y</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <name>angle</name></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>revThruster</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>

        <if>if <condition>(<expr><name><name>game</name><operator>.</operator><name>loaded</name></name></expr>)</condition><then>
            <block type="pseudo"><expr_stmt><expr><call><name><name>game</name><operator>.</operator><name>thrustersSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
        <expr_stmt><expr><name><name>game</name><operator>.</operator><name>thrustersPlaying</name></name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>game</name><operator>.</operator><name>hyperCounter</name></name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt>
    }</block></function>

    <function><specifier>public</specifier> <type><name>double</name></type> <name>getDx</name><parameter_list>()</parameter_list><block>{
        <return>return <expr><name><name>game</name><operator>.</operator><name>SHIP_SPEED_STEP</name></name> <operator>*</operator> <operator>-</operator><call><name><name>Math</name><operator>.</operator><name>sin</name></name><argument_list>(<argument><expr><name>angle</name></expr></argument>)</argument_list></call></expr>;</return>
    }</block></function>

    <function><specifier>public</specifier> <type><name>double</name></type> <name>getDy</name><parameter_list>()</parameter_list> <block>{
        <return>return <expr><name><name>game</name><operator>.</operator><name>SHIP_SPEED_STEP</name></name> <operator>*</operator>  <call><name><name>Math</name><operator>.</operator><name>cos</name></name><argument_list>(<argument><expr><name>angle</name></expr></argument>)</argument_list></call></expr>;</return>
    }</block></function>

    <function><specifier>public</specifier> <type><name>void</name></type> <name>updateMovement</name><parameter_list>()</parameter_list> <block>{
        <if>if <condition>(<expr><name>up</name></expr>)</condition><then> <block>{
            <expr_stmt><expr><name>deltaX</name> <operator>+=</operator> <call><name>getDx</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>deltaY</name> <operator>+=</operator> <call><name>getDy</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        }</block></then></if>
        <if>if <condition>(<expr><name>down</name></expr>)</condition><then> <block>{
            <expr_stmt><expr><name>deltaX</name> <operator>-=</operator> <call><name>getDx</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>deltaY</name> <operator>-=</operator> <call><name>getDy</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        }</block></then></if>
        <if>if <condition>(<expr><name>left</name></expr>)</condition><then> <block>{
            <expr_stmt><expr><name>angle</name> <operator>+=</operator> <name><name>game</name><operator>.</operator><name>SHIP_ANGLE_STEP</name></name></expr>;</expr_stmt>
            <if>if <condition>(<expr><name>angle</name> <operator>&gt;</operator> <literal type="number">2</literal> <operator>*</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name></expr>)</condition><then>
                <block type="pseudo"><expr_stmt><expr><name>angle</name> <operator>-=</operator> <literal type="number">2</literal> <operator>*</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name></expr>;</expr_stmt></block></then></if>
        }</block></then></if>
        <if>if <condition>(<expr><name>right</name></expr>)</condition><then> <block>{
            <expr_stmt><expr><name>angle</name> <operator>-=</operator> <name><name>game</name><operator>.</operator><name>SHIP_ANGLE_STEP</name></name></expr>;</expr_stmt>
            <if>if <condition>(<expr><name>angle</name> <operator>&lt;</operator> <literal type="number">0</literal></expr>)</condition><then>
                <block type="pseudo"><expr_stmt><expr><name>angle</name> <operator>+=</operator> <literal type="number">2</literal> <operator>*</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name></expr>;</expr_stmt></block></then></if>
        }</block></then></if>
        <if>if <condition>(<expr><name>up</name> <operator>||</operator> <name>down</name></expr>)</condition><then> <block>{
            <decl_stmt><decl><type><name>double</name></type> <name>speed</name> <init>= <expr><call><name><name>Math</name><operator>.</operator><name>sqrt</name></name><argument_list>(<argument><expr><name>deltaX</name> <operator>*</operator> <name>deltaX</name> <operator>+</operator> <name>deltaY</name> <operator>*</operator> <name>deltaY</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <if>if <condition>(<expr><name>speed</name> <operator>&gt;</operator> <name><name>game</name><operator>.</operator><name>MAX_SHIP_SPEED</name></name></expr>)</condition><then> <block>{
                <if>if <condition>(<expr><name>up</name></expr>)</condition><then>
                    <block type="pseudo"><expr_stmt><expr><name>deltaX</name> <operator>=</operator> <call><name>getDx</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then>
                <else>else
                    <block type="pseudo"><expr_stmt><expr><name>deltaX</name> <operator>=</operator> <operator>-</operator><call><name>getDx</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></else></if>
                <if>if <condition>(<expr><name>up</name></expr>)</condition><then>
                    <block type="pseudo"><expr_stmt><expr><name>deltaY</name> <operator>=</operator> <call><name>getDy</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then>
                <else>else
                    <block type="pseudo"><expr_stmt><expr><name>deltaY</name> <operator>=</operator> <operator>-</operator><call><name>getDy</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></else></if>
            }</block></then></if>
        }</block></then></if>
    }</block></function>

}</block></class>
</unit>

<unit revision="0.9.5" language="Java" filename="server\RepoHandler\repository\Asteroids\src\SmallAsteroid.java" hash="2d37c132d41bd3728340e7a8363d55becb03b904"><class><specifier>public</specifier> class <name>SmallAsteroid</name> <block>{
}</block></class>
</unit>

<unit revision="0.9.5" language="Java" filename="server\RepoHandler\repository\Asteroids\src\Game.java" hash="21934cc0125847d1cd38f8fb9a31372df1c61806"><import>import <name><name>java</name><operator>.</operator><name>applet</name><operator>.</operator><name>AudioClip</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>awt</name><operator>.</operator><name>*</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>awt</name><operator>.</operator><name>*</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>awt</name><operator>.</operator><name>event</name><operator>.</operator><name>*</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>*</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>*</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>applet</name><operator>.</operator><name>Applet</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>applet</name><operator>.</operator><name>AudioClip</name></name>;</import>

<class><specifier>public</specifier> class <name>Game</name> <block>{

    <comment type="line">// Fields:</comment>

    <decl_stmt><decl><specifier>static</specifier> <type><name>int</name></type> <name>width</name></decl>;</decl_stmt>          <comment type="line">// Dimensions of the graphics area.</comment>
    <decl_stmt><decl><specifier>static</specifier> <type><name>int</name></type> <name>height</name></decl>;</decl_stmt>

    <decl_stmt><decl><type><name>Polygon</name></type> <name>shape</name></decl>;</decl_stmt>             <comment type="line">// Base sprite shape, centered at the origin (0,0).</comment>
    <decl_stmt><decl><type><name>boolean</name></type> <name>active</name></decl>;</decl_stmt>            <comment type="line">// Active flag.</comment>
    <decl_stmt><decl><type><name>double</name></type>  <name>angle</name></decl>;</decl_stmt>             <comment type="line">// Current angle of rotation.</comment>
    <decl_stmt><decl><type><name>double</name></type>  <name>deltaAngle</name></decl>;</decl_stmt>        <comment type="line">// Amount to change the rotation angle.</comment>
    <decl_stmt><decl><type><name>double</name></type>  <name>x</name></decl>, <decl><type ref="prev"/><name>y</name></decl>;</decl_stmt>              <comment type="line">// Current position on screen.</comment>
    <decl_stmt><decl><type><name>double</name></type>  <name>deltaX</name></decl>, <decl><type ref="prev"/><name>deltaY</name></decl>;</decl_stmt>    <comment type="line">// Amount to change the screen position.</comment>
    <decl_stmt><decl><type><name>Polygon</name></type> <name>sprite</name></decl>;</decl_stmt>            <comment type="line">// Final location and shape of sprite after</comment>
    <comment type="line">// applying rotation and translation to get screen</comment>
    <comment type="line">// position. Used for drawing on the screen and in</comment>
    <comment type="line">// detecting collisions.</comment>


    <decl_stmt><decl><type><name>String</name></type> <name>copyName</name> <init>= <expr><literal type="string">"Asteroids"</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>String</name></type> <name>copyVers</name> <init>= <expr><literal type="string">"Version 1.3"</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>String</name></type> <name>copyInfo</name> <init>= <expr><literal type="string">"Copyright 1998-2001 by Mike Hall"</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>String</name></type> <name>copyLink</name> <init>= <expr><literal type="string">"http://www.brainjar.com"</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>String</name></type> <name>copyText</name> <init>= <expr><name>copyName</name> <operator>+</operator> <literal type="char">'\n'</literal> <operator>+</operator> <name>copyVers</name> <operator>+</operator> <literal type="char">'\n'</literal>
            <operator>+</operator> <name>copyInfo</name> <operator>+</operator> <literal type="char">'\n'</literal> <operator>+</operator> <name>copyLink</name></expr></init></decl>;</decl_stmt>

    <comment type="line">// Thread control variables.</comment>

    <decl_stmt><decl><type><name>Thread</name></type> <name>loadThread</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>Thread</name></type> <name>loopThread</name></decl>;</decl_stmt>

    <comment type="line">// Constants</comment>

    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>DELAY</name> <init>= <expr><literal type="number">20</literal></expr></init></decl>;</decl_stmt>             <comment type="line">// Milliseconds between screen and</comment>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>FPS</name>   <init>=                 <comment type="line">// the resulting frame rate.</comment>
            <expr><call><name><name>Math</name><operator>.</operator><name>round</name></name><argument_list>(<argument><expr><literal type="number">1000</literal> <operator>/</operator> <name>DELAY</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MAX_SHOTS</name> <init>=  <expr><literal type="number">8</literal></expr></init></decl>;</decl_stmt>          <comment type="line">// Maximum number of sprites</comment>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MAX_ROCKS</name> <init>=  <expr><literal type="number">8</literal></expr></init></decl>;</decl_stmt>          <comment type="line">// for photons, asteroids and</comment>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MAX_SCRAP</name> <init>= <expr><literal type="number">40</literal></expr></init></decl>;</decl_stmt>          <comment type="line">// explosions.</comment>

    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>SCRAP_COUNT</name>  <init>= <expr><literal type="number">2</literal> <operator>*</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>  <comment type="line">// Timer counter starting values</comment>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>HYPER_COUNT</name>  <init>= <expr><literal type="number">3</literal> <operator>*</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>  <comment type="line">// calculated using number of</comment>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MISSLE_COUNT</name> <init>= <expr><literal type="number">4</literal> <operator>*</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>  <comment type="line">// seconds x frames per second.</comment>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>STORM_PAUSE</name>  <init>= <expr><literal type="number">2</literal> <operator>*</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>

    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type>    <name>MIN_ROCK_SIDES</name> <init>=   <expr><literal type="number">6</literal></expr></init></decl>;</decl_stmt> <comment type="line">// Ranges for asteroid shape, size</comment>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type>    <name>MAX_ROCK_SIDES</name> <init>=  <expr><literal type="number">16</literal></expr></init></decl>;</decl_stmt> <comment type="line">// speed and rotation.</comment>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type>    <name>MIN_ROCK_SIZE</name>  <init>=  <expr><literal type="number">20</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type>    <name>MAX_ROCK_SIZE</name>  <init>=  <expr><literal type="number">40</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>MIN_ROCK_SPEED</name> <init>=  <expr><literal type="number">40.0</literal> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>MAX_ROCK_SPEED</name> <init>= <expr><literal type="number">240.0</literal> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>MAX_ROCK_SPIN</name>  <init>= <expr><name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>

    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MAX_SHIPS</name> <init>= <expr><literal type="number">3</literal></expr></init></decl>;</decl_stmt>           <comment type="line">// Starting number of ships for</comment>
    <comment type="line">// each game.</comment>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>UFO_PASSES</name> <init>= <expr><literal type="number">3</literal></expr></init></decl>;</decl_stmt>          <comment type="line">// Number of passes for flying</comment>
    <comment type="line">// saucer per appearance.</comment>

    <comment type="line">// Ship's rotation and acceleration rates and maximum speed.</comment>

    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>SHIP_ANGLE_STEP</name> <init>= <expr><name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>SHIP_SPEED_STEP</name> <init>= <expr><literal type="number">15.0</literal> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>MAX_SHIP_SPEED</name>  <init>= <expr><literal type="number">1.25</literal> <operator>*</operator> <name>MAX_ROCK_SPEED</name></expr></init></decl>;</decl_stmt>

    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>FIRE_DELAY</name> <init>= <expr><literal type="number">50</literal></expr></init></decl>;</decl_stmt>         <comment type="line">// Minimum number of milliseconds</comment>
    <comment type="line">// required between photon shots.</comment>

    <comment type="line">// Probablility of flying saucer firing a missle during any given frame</comment>
    <comment type="line">// (other conditions must be met).</comment>

    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>MISSLE_PROBABILITY</name> <init>= <expr><literal type="number">0.45</literal> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>

    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>BIG_POINTS</name>    <init>=  <expr><literal type="number">25</literal></expr></init></decl>;</decl_stmt>     <comment type="line">// Points scored for shooting</comment>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>SMALL_POINTS</name>  <init>=  <expr><literal type="number">50</literal></expr></init></decl>;</decl_stmt>     <comment type="line">// various objects.</comment>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>UFO_POINTS</name>    <init>= <expr><literal type="number">250</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MISSLE_POINTS</name> <init>= <expr><literal type="number">500</literal></expr></init></decl>;</decl_stmt>

    <comment type="line">// Number of points the must be scored to earn a new ship or to cause the</comment>
    <comment type="line">// flying saucer to appear.</comment>

    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>NEW_SHIP_POINTS</name> <init>= <expr><literal type="number">5000</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>NEW_UFO_POINTS</name>  <init>= <expr><literal type="number">2750</literal></expr></init></decl>;</decl_stmt>

    <comment type="line">// Background stars.</comment>

    <decl_stmt><decl><type><name>int</name></type>     <name>numStars</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name><name>Point</name><index>[]</index></name></type> <name>stars</name></decl>;</decl_stmt>

    <comment type="line">// Game data.</comment>

    <decl_stmt><decl><type><name>int</name></type> <name>score</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>highScore</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>newShipScore</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>newUfoScore</name></decl>;</decl_stmt>

    <comment type="line">// Flags for game state and options.</comment>

    <decl_stmt><decl><type><name>boolean</name></type> <name>loaded</name> <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>boolean</name></type> <name>paused</name></decl>;</decl_stmt>
    <decl_stmt><decl><specifier>static</specifier> <type><name>boolean</name></type> <name>playing</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>boolean</name></type> <name>sound</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>boolean</name></type> <name>detail</name></decl>;</decl_stmt>

    <comment type="line">// Key flags.</comment>

    <decl_stmt><decl><type><name>boolean</name></type> <name>left</name>  <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>boolean</name></type> <name>right</name> <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>boolean</name></type> <name>up</name>    <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>boolean</name></type> <name>down</name>  <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>

    <comment type="line">// Sprite objects.</comment>

    <decl_stmt><decl><type><name>AsteroidsSprite</name></type>   <name>ship</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>AsteroidsSprite</name></type>   <name>fwdThruster</name></decl>, <decl><type ref="prev"/><name>revThruster</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>AsteroidsSprite</name></type>   <name>ufo</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>AsteroidsSprite</name></type>   <name>missle</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name><name>AsteroidsSprite</name><index>[]</index></name></type> <name>photons</name>    <init>= <expr><operator>new</operator> <name><name>AsteroidsSprite</name><index>[<expr><name>MAX_SHOTS</name></expr>]</index></name></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name><name>AsteroidsSprite</name><index>[]</index></name></type> <name>asteroids</name>  <init>= <expr><operator>new</operator> <name><name>AsteroidsSprite</name><index>[<expr><name>MAX_ROCKS</name></expr>]</index></name></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name><name>AsteroidsSprite</name><index>[]</index></name></type> <name>explosions</name> <init>= <expr><operator>new</operator> <name><name>AsteroidsSprite</name><index>[<expr><name>MAX_SCRAP</name></expr>]</index></name></expr></init></decl>;</decl_stmt>

    <comment type="line">// Ship data.</comment>

    <decl_stmt><decl><type><name>int</name></type> <name>shipsLeft</name></decl>;</decl_stmt>       <comment type="line">// Number of ships left in game, including current one.</comment>
    <decl_stmt><decl><type><name>int</name></type> <name>shipCounter</name></decl>;</decl_stmt>     <comment type="line">// Timer counter for ship explosion.</comment>
    <decl_stmt><decl><type><name>int</name></type> <name>hyperCounter</name></decl>;</decl_stmt>    <comment type="line">// Timer counter for hyperspace.</comment>

    <comment type="line">// Photon data.</comment>

    <decl_stmt><decl><type><name>int</name></type>   <name>photonIndex</name></decl>;</decl_stmt>    <comment type="line">// Index to next available photon sprite.</comment>
    <decl_stmt><decl><type><name>long</name></type>  <name>photonTime</name></decl>;</decl_stmt>     <comment type="line">// Time value used to keep firing rate constant.</comment>

    <comment type="line">// Flying saucer data.</comment>

    <decl_stmt><decl><type><name>int</name></type> <name>ufoPassesLeft</name></decl>;</decl_stmt>    <comment type="line">// Counter for number of flying saucer passes.</comment>
    <decl_stmt><decl><type><name>int</name></type> <name>ufoCounter</name></decl>;</decl_stmt>       <comment type="line">// Timer counter used to track each flying saucer pass.</comment>

    <comment type="line">// Missle data.</comment>

    <decl_stmt><decl><type><name>int</name></type> <name>missleCounter</name></decl>;</decl_stmt>    <comment type="line">// Counter for life of missle.</comment>

    <comment type="line">// Asteroid data.</comment>

    <decl_stmt><decl><type><name><name>boolean</name><index>[]</index></name></type> <name>asteroidIsSmall</name> <init>= <expr><operator>new</operator> <name><name>boolean</name><index>[<expr><name>MAX_ROCKS</name></expr>]</index></name></expr></init></decl>;</decl_stmt>    <comment type="line">// Asteroid size flag.</comment>
    <decl_stmt><decl><type><name>int</name></type>       <name>asteroidsCounter</name></decl>;</decl_stmt>                            <comment type="line">// Break-time counter.</comment>
    <decl_stmt><decl><type><name>double</name></type>    <name>asteroidsSpeed</name></decl>;</decl_stmt>                              <comment type="line">// Asteroid speed.</comment>
    <decl_stmt><decl><type><name>int</name></type>       <name>asteroidsLeft</name></decl>;</decl_stmt>                               <comment type="line">// Number of active asteroids.</comment>

    <comment type="line">// Explosion data.</comment>

    <decl_stmt><decl><type><name><name>int</name><index>[]</index></name></type> <name>explosionCounter</name> <init>= <expr><operator>new</operator> <name><name>int</name><index>[<expr><name>MAX_SCRAP</name></expr>]</index></name></expr></init></decl>;</decl_stmt>  <comment type="line">// Time counters for explosions.</comment>
    <decl_stmt><decl><type><name>int</name></type>   <name>explosionIndex</name></decl>;</decl_stmt>                         <comment type="line">// Next available explosion sprite.</comment>

    <comment type="line">// Sound clips.</comment>

    <decl_stmt><decl><type><name>AudioClip</name></type> <name>crashSound</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>AudioClip</name></type> <name>explosionSound</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>AudioClip</name></type> <name>fireSound</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>AudioClip</name></type> <name>missleSound</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>AudioClip</name></type> <name>saucerSound</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>AudioClip</name></type> <name>thrustersSound</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>AudioClip</name></type> <name>warpSound</name></decl>;</decl_stmt>

    <comment type="line">// Flags for looping sound clips.</comment>

    <decl_stmt><decl><type><name>boolean</name></type> <name>thrustersPlaying</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>boolean</name></type> <name>saucerPlaying</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>boolean</name></type> <name>misslePlaying</name></decl>;</decl_stmt>

    <comment type="line">// Counter and total used to track the loading of the sound clips.</comment>

    <decl_stmt><decl><type><name>int</name></type> <name>clipTotal</name>   <init>= <expr><literal type="number">0</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>clipsLoaded</name> <init>= <expr><literal type="number">0</literal></expr></init></decl>;</decl_stmt>

    <comment type="line">// Off screen image.</comment>

    <decl_stmt><decl><type><name>Dimension</name></type> <name>offDimension</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>Image</name></type>     <name>offImage</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>Graphics</name></type>  <name>offGraphics</name></decl>;</decl_stmt>

    <comment type="line">// Data for the screen font.</comment>

    <decl_stmt><decl><type><name>Font</name></type> <name>font</name>      <init>= <expr><operator>new</operator> <call><name>Font</name><argument_list>(<argument><expr><literal type="string">"Helvetica"</literal></expr></argument>, <argument><expr><name><name>Font</name><operator>.</operator><name>BOLD</name></name></expr></argument>, <argument><expr><literal type="number">12</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
    <comment type="line">//FontMetrics fm = getFontMetrics(font);</comment>
    <comment type="line">//int fontWidth  = fm.getMaxAdvance();</comment>
    <comment type="line">//int fontHeight = fm.getHeight();</comment>

    <decl_stmt><decl><type><name>Ship</name></type> <name>ship</name> <init>= <expr><operator>new</operator> <call><name>Ship</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>Photons</name></type> <name>photons</name> <init>= <expr><operator>new</operator> <call><name>Photons</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>Ufo</name></type> <name>ufo</name> <init>= <expr><operator>new</operator> <call><name>Ufo</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>Missile</name></type> <name>missile</name> <init>= <expr><operator>new</operator> <call><name>Missile</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>Asteroid</name></type> <name>asteroids</name> <init>= <expr><operator>new</operator> <call><name>Asteroid</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>Explosion</name></type> <name>explosions</name> <init>= <expr><operator>new</operator> <call><name>Explosion</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>


    <function><specifier>public</specifier> <type><name>void</name></type> <name>initGame</name><parameter_list>()</parameter_list> <block>{

        <comment type="line">// Initialize game data and sprites.</comment>

        <expr_stmt><expr><name>score</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name>shipsLeft</name> <operator>=</operator> <name>MAX_SHIPS</name></expr>;</expr_stmt>
        <expr_stmt><expr><name>asteroidsSpeed</name> <operator>=</operator> <name>MIN_ROCK_SPEED</name></expr>;</expr_stmt>
        <expr_stmt><expr><name>newShipScore</name> <operator>=</operator> <name>NEW_SHIP_POINTS</name></expr>;</expr_stmt>
        <expr_stmt><expr><name>newUfoScore</name> <operator>=</operator> <name>NEW_UFO_POINTS</name></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>ship</name><operator>.</operator><name>initShip</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>photons</name><operator>.</operator><name>initPhotons</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>stopUfo</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>missile</name><operator>.</operator><name>stopMissle</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>asteroids</name><operator>.</operator><name>initAsteroids</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>explosions</name><operator>.</operator><name>initExplosions</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>playing</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name>paused</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name>photonTime</name> <operator>=</operator> <call><name><name>System</name><operator>.</operator><name>currentTimeMillis</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    }</block></function>


}</block></class>
</unit>

<unit revision="0.9.5" language="Java" filename="server\RepoHandler\repository\Asteroids\src\Thruster.java" hash="1a11640a5130c6b3fc4911f1e5aed8ed574c0312"><class><specifier>public</specifier> class <name>Thruster</name> <block>{

    <decl_stmt><decl><type><name>AsteroidsSprite</name></type>   <name>fwdThruster</name></decl>, <decl><type ref="prev"/><name>revThruster</name></decl>;</decl_stmt>
    <constructor><specifier>private</specifier>

    <specifier>public</specifier> <name>Thruster</name><parameter_list>()</parameter_list> <block>{

    }</block></constructor>

    <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>x</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>x</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>y</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>y</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>angle</name></name></expr>;</expr_stmt>
    <constructor_decl><name><name>fwdThruster</name><operator>.</operator><name>render</name></name><parameter_list>()</parameter_list>;</constructor_decl>
    <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>x</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>x</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>y</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>y</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>angle</name></name></expr>;</expr_stmt>
    <constructor_decl><name><name>revThruster</name><operator>.</operator><name>render</name></name><parameter_list>()</parameter_list>;</constructor_decl>

}</block></class>
</unit>

<unit revision="0.9.5" language="Java" filename="server\RepoHandler\repository\Asteroids\src\UI.java" hash="ec41a731d810c2877cc81f99e5b67e7a3ada0679"><class><specifier>public</specifier> class <name>UI</name> <block>{

    <decl_stmt><decl><type><name>Ship</name></type> <name>ship</name></decl>;</decl_stmt>

    <decl_stmt><decl><type><name>Game</name></type> <name>cs</name> <init>= <expr><operator>new</operator> <call><name>Game</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>

    <constructor><specifier>public</specifier> <name>UI</name><parameter_list>()</parameter_list><block>{

    }</block></constructor>

    <function><specifier>public</specifier> <type><name>void</name></type> <name>render</name><parameter_list>()</parameter_list><block>{

    }</block></function>

    <function><specifier>public</specifier> <type><name>void</name></type> <name>update</name><parameter_list>()</parameter_list> <block>{

    }</block></function>


}</block></class>



    <comment type="line">// Move the ship. If it is currently in hyperspace, advance the countdown.</comment>

    <if>if <condition>(<expr><name><name>ship</name><operator>.</operator><name>active</name></name></expr>)</condition><then> <block>{
        <expr_stmt><expr><call><name><name>ship</name><operator>.</operator><name>advance</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>ship</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <if>if <condition>(<expr><name>hyperCounter</name> <operator>&gt;</operator> <literal type="number">0</literal></expr>)</condition><then>
            <block type="pseudo"><expr_stmt><expr><name>hyperCounter</name><operator>--</operator></expr>;</expr_stmt></block></then></if>

        <comment type="line">// Update the thruster sprites to match the ship sprite.</comment>

        <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>x</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>x</name></name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>y</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>y</name></name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>angle</name></name></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>fwdThruster</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>x</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>x</name></name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>y</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>y</name></name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>angle</name></name></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>revThruster</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
}</block></then></if>
</unit>

<unit revision="0.9.5" language="Java" filename="server\RepoHandler\repository\Asteroids\src\Ufo.java" hash="38163f4f29f3a281f0f12f3d32c2534143eee842"><class><specifier>public</specifier> class <name>Ufo</name> <block>{
}</block></class>
</unit>

<unit revision="0.9.5" language="Java" filename="server\RepoHandler\repository\Asteroids\src\Sound.java" hash="2473a6d82df585ce47f7f997ddacb72b83cff29e"><import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>MalformedURLException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URL</name></name>;</import>

<class><specifier>public</specifier> class <name>Sound</name> <block>{

    <function><specifier>public</specifier> <type><name>void</name></type> <name>loadSounds</name><parameter_list>()</parameter_list> <block>{

        <comment type="line">// Load all sound clips by playing and immediately stopping them. Update</comment>
        <comment type="line">// counter and total for display.</comment>

        <try>try <block>{
            <expr_stmt><expr><name>crashSound</name>     <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"crash.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
            <expr_stmt><expr><name>explosionSound</name> <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"explosion.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
            <expr_stmt><expr><name>fireSound</name>      <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"fire.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
            <expr_stmt><expr><name>missleSound</name>    <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"missle.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
            <expr_stmt><expr><name>saucerSound</name>    <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"saucer.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
            <expr_stmt><expr><name>thrustersSound</name> <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"thrusters.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
            <expr_stmt><expr><name>warpSound</name>      <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"warp.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
        }</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>MalformedURLException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{}</block></catch></try>

        <try>try <block>{
            <expr_stmt><expr><call><name><name>crashSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>     <expr_stmt><expr><call><name><name>crashSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>     <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>explosionSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>explosionSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>fireSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>      <expr_stmt><expr><call><name><name>fireSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>      <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>missleSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>    <expr_stmt><expr><call><name><name>missleSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>    <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>saucerSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>    <expr_stmt><expr><call><name><name>saucerSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>    <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>thrustersSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>thrustersSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>warpSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>      <expr_stmt><expr><call><name><name>warpSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>      <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>InterruptedException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{}</block></catch></try>
    }</block></function>

}</block></class>
</unit>

<unit revision="0.9.5" language="Java" filename="server\RepoHandler\repository\Asteroids\src\Asteroids.java" hash="1b10da486f379606b49f7e98ad8a92754d1b7aef"><comment type="block" format="javadoc">/******************************************************************************
  Asteroids, Version 1.3

  Copyright 1998-2001 by Mike Hall.
  Please see http://www.brainjar.com for terms of use.

  Revision History:

  1.01, 12/18/1999: Increased number of active photons allowed.
                    Improved explosions for more realism.
                    Added progress bar for loading of sound clips.
  1.2,  12/23/1999: Increased frame rate for smoother animation.
                    Modified code to calculate game object speeds and timer
                    counters based on the frame rate so they will remain
                    constant.
                    Improved speed limit checking for ship.
                    Removed wrapping of photons around screen and set a fixed
                    firing rate.
                    Added sprites for ship's thrusters.
  1.3,  01/25/2001: Updated to JDK 1.1.8.

  Usage:

  &lt;applet code="Asteroids.class" width=w height=h&gt;&lt;/applet&gt;

  Keyboard Controls:

  S            - Start Game    P           - Pause Game
  Cursor Left  - Rotate Left   Cursor Up   - Fire Thrusters
  Cursor Right - Rotate Right  Cursor Down - Fire Retro Thrusters
  Spacebar     - Fire Cannon   H           - Hyperspace
  M            - Toggle Sound  D           - Toggle Graphics Detail

******************************************************************************/</comment>

<import>import <name><name>java</name><operator>.</operator><name>awt</name><operator>.</operator><name>*</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>awt</name><operator>.</operator><name>event</name><operator>.</operator><name>*</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>*</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>*</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>applet</name><operator>.</operator><name>Applet</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>applet</name><operator>.</operator><name>AudioClip</name></name>;</import>

<comment type="block" format="javadoc">/******************************************************************************
  The AsteroidsSprite class defines a game object, including it's shape,
  position, movement and rotation. It also can detemine if two objects collide.
******************************************************************************/</comment>

<class>class <name>AsteroidsSprite</name> <block>{

  <comment type="line">// Fields:</comment>

  <decl_stmt><decl><specifier>static</specifier> <type><name>int</name></type> <name>width</name></decl>;</decl_stmt>          <comment type="line">// Dimensions of the graphics area.</comment>
  <decl_stmt><decl><specifier>static</specifier> <type><name>int</name></type> <name>height</name></decl>;</decl_stmt>

  <decl_stmt><decl><type><name>Polygon</name></type> <name>shape</name></decl>;</decl_stmt>             <comment type="line">// Base sprite shape, centered at the origin (0,0).</comment>
  <decl_stmt><decl><type><name>boolean</name></type> <name>active</name></decl>;</decl_stmt>            <comment type="line">// Active flag.</comment>
  <decl_stmt><decl><type><name>double</name></type>  <name>angle</name></decl>;</decl_stmt>             <comment type="line">// Current angle of rotation.</comment>
  <decl_stmt><decl><type><name>double</name></type>  <name>deltaAngle</name></decl>;</decl_stmt>        <comment type="line">// Amount to change the rotation angle.</comment>
  <decl_stmt><decl><type><name>double</name></type>  <name>x</name></decl>, <decl><type ref="prev"/><name>y</name></decl>;</decl_stmt>              <comment type="line">// Current position on screen.</comment>
  <decl_stmt><decl><type><name>double</name></type>  <name>deltaX</name></decl>, <decl><type ref="prev"/><name>deltaY</name></decl>;</decl_stmt>    <comment type="line">// Amount to change the screen position.</comment>
  <decl_stmt><decl><type><name>Polygon</name></type> <name>sprite</name></decl>;</decl_stmt>            <comment type="line">// Final location and shape of sprite after</comment>
                             <comment type="line">// applying rotation and translation to get screen</comment>
                             <comment type="line">// position. Used for drawing on the screen and in</comment>
                             <comment type="line">// detecting collisions.</comment>

  <comment type="line">// Constructors:</comment>

  <constructor><specifier>public</specifier> <name>AsteroidsSprite</name><parameter_list>()</parameter_list> <block>{

    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>shape</name></name> <operator>=</operator> <operator>new</operator> <call><name>Polygon</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>active</name></name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>deltaAngle</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>x</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>y</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>deltaX</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>deltaY</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>sprite</name></name> <operator>=</operator> <operator>new</operator> <call><name>Polygon</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
  }</block></constructor>

  <comment type="line">// Methods:</comment>

  <function><specifier>public</specifier> <type><name>boolean</name></type> <name>advance</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>boolean</name></type> <name>wrapped</name></decl>;</decl_stmt>

    <comment type="line">// Update the rotation and position of the sprite based on the delta</comment>
    <comment type="line">// values. If the sprite moves off the edge of the screen, it is wrapped</comment>
    <comment type="line">// around to the other side and TRUE is returnd.</comment>

    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>angle</name></name> <operator>+=</operator> <name><name>this</name><operator>.</operator><name>deltaAngle</name></name></expr>;</expr_stmt>
    <if>if <condition>(<expr><name><name>this</name><operator>.</operator><name>angle</name></name> <operator>&lt;</operator> <literal type="number">0</literal></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name><name>this</name><operator>.</operator><name>angle</name></name> <operator>+=</operator> <literal type="number">2</literal> <operator>*</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name></expr>;</expr_stmt></block></then></if>
    <if>if <condition>(<expr><name><name>this</name><operator>.</operator><name>angle</name></name> <operator>&gt;</operator> <literal type="number">2</literal> <operator>*</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name><name>this</name><operator>.</operator><name>angle</name></name> <operator>-=</operator> <literal type="number">2</literal> <operator>*</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name></expr>;</expr_stmt></block></then></if>
    <expr_stmt><expr><name>wrapped</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>x</name></name> <operator>+=</operator> <name><name>this</name><operator>.</operator><name>deltaX</name></name></expr>;</expr_stmt>
    <if>if <condition>(<expr><name><name>this</name><operator>.</operator><name>x</name></name> <operator>&lt;</operator> <operator>-</operator><name>width</name> <operator>/</operator> <literal type="number">2</literal></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>this</name><operator>.</operator><name>x</name></name> <operator>+=</operator> <name>width</name></expr>;</expr_stmt>
      <expr_stmt><expr><name>wrapped</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
    }</block></then></if>
    <if>if <condition>(<expr><name><name>this</name><operator>.</operator><name>x</name></name> <operator>&gt;</operator> <name>width</name> <operator>/</operator> <literal type="number">2</literal></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>this</name><operator>.</operator><name>x</name></name> <operator>-=</operator> <name>width</name></expr>;</expr_stmt>
      <expr_stmt><expr><name>wrapped</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
    }</block></then></if>
    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>y</name></name> <operator>-=</operator> <name><name>this</name><operator>.</operator><name>deltaY</name></name></expr>;</expr_stmt>
    <if>if <condition>(<expr><name><name>this</name><operator>.</operator><name>y</name></name> <operator>&lt;</operator> <operator>-</operator><name>height</name> <operator>/</operator> <literal type="number">2</literal></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>this</name><operator>.</operator><name>y</name></name> <operator>+=</operator> <name>height</name></expr>;</expr_stmt>
      <expr_stmt><expr><name>wrapped</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
    }</block></then></if>
    <if>if <condition>(<expr><name><name>this</name><operator>.</operator><name>y</name></name> <operator>&gt;</operator> <name>height</name> <operator>/</operator> <literal type="number">2</literal></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>this</name><operator>.</operator><name>y</name></name> <operator>-=</operator> <name>height</name></expr>;</expr_stmt>
      <expr_stmt><expr><name>wrapped</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
    }</block></then></if>

    <return>return <expr><name>wrapped</name></expr>;</return>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>render</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>;</decl_stmt>

    <comment type="line">// Render the sprite's shape and location by rotating it's base shape and</comment>
    <comment type="line">// moving it to it's proper screen position.</comment>

    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>sprite</name></name> <operator>=</operator> <operator>new</operator> <call><name>Polygon</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name><name>this</name><operator>.</operator><name>shape</name><operator>.</operator><name>npoints</name></name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
      <block type="pseudo"><expr_stmt><expr><call><name><name>this</name><operator>.</operator><name>sprite</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>(</operator><name>int</name><operator>)</operator> <call><name><name>Math</name><operator>.</operator><name>round</name></name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>shape</name><operator>.</operator><name>xpoints</name><index>[<expr><name>i</name></expr>]</index></name> <operator>*</operator> <call><name><name>Math</name><operator>.</operator><name>cos</name></name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>angle</name></name></expr></argument>)</argument_list></call> <operator>+</operator> <name><name>this</name><operator>.</operator><name>shape</name><operator>.</operator><name>ypoints</name><index>[<expr><name>i</name></expr>]</index></name> <operator>*</operator> <call><name><name>Math</name><operator>.</operator><name>sin</name></name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>angle</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call> <operator>+</operator> <operator>(</operator><name>int</name><operator>)</operator> <call><name><name>Math</name><operator>.</operator><name>round</name></name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>x</name></name></expr></argument>)</argument_list></call> <operator>+</operator> <name>width</name> <operator>/</operator> <literal type="number">2</literal></expr></argument>,
                           <argument><expr><operator>(</operator><name>int</name><operator>)</operator> <call><name><name>Math</name><operator>.</operator><name>round</name></name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>shape</name><operator>.</operator><name>ypoints</name><index>[<expr><name>i</name></expr>]</index></name> <operator>*</operator> <call><name><name>Math</name><operator>.</operator><name>cos</name></name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>angle</name></name></expr></argument>)</argument_list></call> <operator>-</operator> <name><name>this</name><operator>.</operator><name>shape</name><operator>.</operator><name>xpoints</name><index>[<expr><name>i</name></expr>]</index></name> <operator>*</operator> <call><name><name>Math</name><operator>.</operator><name>sin</name></name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>angle</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call> <operator>+</operator> <operator>(</operator><name>int</name><operator>)</operator> <call><name><name>Math</name><operator>.</operator><name>round</name></name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>y</name></name></expr></argument>)</argument_list></call> <operator>+</operator> <name>height</name> <operator>/</operator> <literal type="number">2</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt></block></for>
  }</block></function>

  <function><specifier>public</specifier> <type><name>boolean</name></type> <name>isColliding</name><parameter_list>(<parameter><decl><type><name>AsteroidsSprite</name></type> <name>s</name></decl></parameter>)</parameter_list> <block>{

    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>;</decl_stmt>

    <comment type="line">// Determine if one sprite overlaps with another, i.e., if any vertice</comment>
    <comment type="line">// of one sprite lands inside the other.</comment>

    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name><name>s</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
      <block type="pseudo"><if>if <condition>(<expr><call><name><name>this</name><operator>.</operator><name>sprite</name><operator>.</operator><name>contains</name></name><argument_list>(<argument><expr><name><name>s</name><operator>.</operator><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><name>i</name></expr>]</index></name></expr></argument>, <argument><expr><name><name>s</name><operator>.</operator><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><name>i</name></expr>]</index></name></expr></argument>)</argument_list></call></expr>)</condition><then>
        <block type="pseudo"><return>return <expr><literal type="boolean">true</literal></expr>;</return></block></then></if></block></for>
    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name><name>this</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
      <block type="pseudo"><if>if <condition>(<expr><call><name><name>s</name><operator>.</operator><name>sprite</name><operator>.</operator><name>contains</name></name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><name>i</name></expr>]</index></name></expr></argument>, <argument><expr><name><name>this</name><operator>.</operator><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><name>i</name></expr>]</index></name></expr></argument>)</argument_list></call></expr>)</condition><then>
        <block type="pseudo"><return>return <expr><literal type="boolean">true</literal></expr>;</return></block></then></if></block></for>
    <return>return <expr><literal type="boolean">false</literal></expr>;</return>
  }</block></function>
}</block></class>

<comment type="block" format="javadoc">/******************************************************************************
  Main applet code.
******************************************************************************/</comment>

<class><specifier>public</specifier> class <name>Asteroids</name> <super><extends>extends <name>Applet</name></extends> <implements>implements <name>Runnable</name>, <name>KeyListener</name></implements></super> <block>{

  <comment type="line">// Copyright information.</comment>

  <decl_stmt><decl><type><name>String</name></type> <name>copyName</name> <init>= <expr><literal type="string">"Asteroids"</literal></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>String</name></type> <name>copyVers</name> <init>= <expr><literal type="string">"Version 1.3"</literal></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>String</name></type> <name>copyInfo</name> <init>= <expr><literal type="string">"Copyright 1998-2001 by Mike Hall"</literal></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>String</name></type> <name>copyLink</name> <init>= <expr><literal type="string">"http://www.brainjar.com"</literal></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>String</name></type> <name>copyText</name> <init>= <expr><name>copyName</name> <operator>+</operator> <literal type="char">'\n'</literal> <operator>+</operator> <name>copyVers</name> <operator>+</operator> <literal type="char">'\n'</literal>
                  <operator>+</operator> <name>copyInfo</name> <operator>+</operator> <literal type="char">'\n'</literal> <operator>+</operator> <name>copyLink</name></expr></init></decl>;</decl_stmt>

  <comment type="line">// Thread control variables.</comment>

  <decl_stmt><decl><type><name>Thread</name></type> <name>loadThread</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>Thread</name></type> <name>loopThread</name></decl>;</decl_stmt>

  <comment type="line">// Constants</comment>

  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>DELAY</name> <init>= <expr><literal type="number">20</literal></expr></init></decl>;</decl_stmt>             <comment type="line">// Milliseconds between screen and</comment>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>FPS</name>   <init>=                 <comment type="line">// the resulting frame rate.</comment>
    <expr><call><name><name>Math</name><operator>.</operator><name>round</name></name><argument_list>(<argument><expr><literal type="number">1000</literal> <operator>/</operator> <name>DELAY</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MAX_SHOTS</name> <init>=  <expr><literal type="number">8</literal></expr></init></decl>;</decl_stmt>          <comment type="line">// Maximum number of sprites</comment>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MAX_ROCKS</name> <init>=  <expr><literal type="number">8</literal></expr></init></decl>;</decl_stmt>          <comment type="line">// for photons, asteroids and</comment>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MAX_SCRAP</name> <init>= <expr><literal type="number">40</literal></expr></init></decl>;</decl_stmt>          <comment type="line">// explosions.</comment>

  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>SCRAP_COUNT</name>  <init>= <expr><literal type="number">2</literal> <operator>*</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>  <comment type="line">// Timer counter starting values</comment>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>HYPER_COUNT</name>  <init>= <expr><literal type="number">3</literal> <operator>*</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>  <comment type="line">// calculated using number of</comment>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MISSLE_COUNT</name> <init>= <expr><literal type="number">4</literal> <operator>*</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>  <comment type="line">// seconds x frames per second.</comment>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>STORM_PAUSE</name>  <init>= <expr><literal type="number">2</literal> <operator>*</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>

  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type>    <name>MIN_ROCK_SIDES</name> <init>=   <expr><literal type="number">6</literal></expr></init></decl>;</decl_stmt> <comment type="line">// Ranges for asteroid shape, size</comment>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type>    <name>MAX_ROCK_SIDES</name> <init>=  <expr><literal type="number">16</literal></expr></init></decl>;</decl_stmt> <comment type="line">// speed and rotation.</comment>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type>    <name>MIN_ROCK_SIZE</name>  <init>=  <expr><literal type="number">20</literal></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type>    <name>MAX_ROCK_SIZE</name>  <init>=  <expr><literal type="number">40</literal></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>MIN_ROCK_SPEED</name> <init>=  <expr><literal type="number">40.0</literal> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>MAX_ROCK_SPEED</name> <init>= <expr><literal type="number">240.0</literal> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>MAX_ROCK_SPIN</name>  <init>= <expr><name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>

  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MAX_SHIPS</name> <init>= <expr><literal type="number">3</literal></expr></init></decl>;</decl_stmt>           <comment type="line">// Starting number of ships for</comment>
                                            <comment type="line">// each game.</comment>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>UFO_PASSES</name> <init>= <expr><literal type="number">3</literal></expr></init></decl>;</decl_stmt>          <comment type="line">// Number of passes for flying</comment>
                                            <comment type="line">// saucer per appearance.</comment>

  <comment type="line">// Ship's rotation and acceleration rates and maximum speed.</comment>

  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>SHIP_ANGLE_STEP</name> <init>= <expr><name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>SHIP_SPEED_STEP</name> <init>= <expr><literal type="number">15.0</literal> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>MAX_SHIP_SPEED</name>  <init>= <expr><literal type="number">1.25</literal> <operator>*</operator> <name>MAX_ROCK_SPEED</name></expr></init></decl>;</decl_stmt>

  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>FIRE_DELAY</name> <init>= <expr><literal type="number">50</literal></expr></init></decl>;</decl_stmt>         <comment type="line">// Minimum number of milliseconds</comment>
                                            <comment type="line">// required between photon shots.</comment>

  <comment type="line">// Probablility of flying saucer firing a missle during any given frame</comment>
  <comment type="line">// (other conditions must be met).</comment>

  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>double</name></type> <name>MISSLE_PROBABILITY</name> <init>= <expr><literal type="number">0.45</literal> <operator>/</operator> <name>FPS</name></expr></init></decl>;</decl_stmt>

  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>BIG_POINTS</name>    <init>=  <expr><literal type="number">25</literal></expr></init></decl>;</decl_stmt>     <comment type="line">// Points scored for shooting</comment>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>SMALL_POINTS</name>  <init>=  <expr><literal type="number">50</literal></expr></init></decl>;</decl_stmt>     <comment type="line">// various objects.</comment>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>UFO_POINTS</name>    <init>= <expr><literal type="number">250</literal></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>MISSLE_POINTS</name> <init>= <expr><literal type="number">500</literal></expr></init></decl>;</decl_stmt>

  <comment type="line">// Number of points the must be scored to earn a new ship or to cause the</comment>
  <comment type="line">// flying saucer to appear.</comment>

  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>NEW_SHIP_POINTS</name> <init>= <expr><literal type="number">5000</literal></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><specifier>static</specifier> <type><specifier>final</specifier> <name>int</name></type> <name>NEW_UFO_POINTS</name>  <init>= <expr><literal type="number">2750</literal></expr></init></decl>;</decl_stmt>

  <comment type="line">// Background stars.</comment>

  <decl_stmt><decl><type><name>int</name></type>     <name>numStars</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name><name>Point</name><index>[]</index></name></type> <name>stars</name></decl>;</decl_stmt>

  <comment type="line">// Game data.</comment>

  <decl_stmt><decl><type><name>int</name></type> <name>score</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>int</name></type> <name>highScore</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>int</name></type> <name>newShipScore</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>int</name></type> <name>newUfoScore</name></decl>;</decl_stmt>

  <comment type="line">// Flags for game state and options.</comment>

  <decl_stmt><decl><type><name>boolean</name></type> <name>loaded</name> <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>boolean</name></type> <name>paused</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>boolean</name></type> <name>playing</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>boolean</name></type> <name>sound</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>boolean</name></type> <name>detail</name></decl>;</decl_stmt>

  <comment type="line">// Key flags.</comment>

  <decl_stmt><decl><type><name>boolean</name></type> <name>left</name>  <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>boolean</name></type> <name>right</name> <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>boolean</name></type> <name>up</name>    <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>boolean</name></type> <name>down</name>  <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>

  <comment type="line">// Sprite objects.</comment>

  <decl_stmt><decl><type><name>AsteroidsSprite</name></type>   <name>ship</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>AsteroidsSprite</name></type>   <name>fwdThruster</name></decl>, <decl><type ref="prev"/><name>revThruster</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>AsteroidsSprite</name></type>   <name>ufo</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>AsteroidsSprite</name></type>   <name>missle</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name><name>AsteroidsSprite</name><index>[]</index></name></type> <name>photons</name>    <init>= <expr><operator>new</operator> <name><name>AsteroidsSprite</name><index>[<expr><name>MAX_SHOTS</name></expr>]</index></name></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name><name>AsteroidsSprite</name><index>[]</index></name></type> <name>asteroids</name>  <init>= <expr><operator>new</operator> <name><name>AsteroidsSprite</name><index>[<expr><name>MAX_ROCKS</name></expr>]</index></name></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name><name>AsteroidsSprite</name><index>[]</index></name></type> <name>explosions</name> <init>= <expr><operator>new</operator> <name><name>AsteroidsSprite</name><index>[<expr><name>MAX_SCRAP</name></expr>]</index></name></expr></init></decl>;</decl_stmt>

  <comment type="line">// Ship data.</comment>

  <decl_stmt><decl><type><name>int</name></type> <name>shipsLeft</name></decl>;</decl_stmt>       <comment type="line">// Number of ships left in game, including current one.</comment>
  <decl_stmt><decl><type><name>int</name></type> <name>shipCounter</name></decl>;</decl_stmt>     <comment type="line">// Timer counter for ship explosion.</comment>
  <decl_stmt><decl><type><name>int</name></type> <name>hyperCounter</name></decl>;</decl_stmt>    <comment type="line">// Timer counter for hyperspace.</comment>

  <comment type="line">// Photon data.</comment>

  <decl_stmt><decl><type><name>int</name></type>   <name>photonIndex</name></decl>;</decl_stmt>    <comment type="line">// Index to next available photon sprite.</comment>
  <decl_stmt><decl><type><name>long</name></type>  <name>photonTime</name></decl>;</decl_stmt>     <comment type="line">// Time value used to keep firing rate constant.</comment>

  <comment type="line">// Flying saucer data.</comment>

  <decl_stmt><decl><type><name>int</name></type> <name>ufoPassesLeft</name></decl>;</decl_stmt>    <comment type="line">// Counter for number of flying saucer passes.</comment>
  <decl_stmt><decl><type><name>int</name></type> <name>ufoCounter</name></decl>;</decl_stmt>       <comment type="line">// Timer counter used to track each flying saucer pass.</comment>

  <comment type="line">// Missle data.</comment>

  <decl_stmt><decl><type><name>int</name></type> <name>missleCounter</name></decl>;</decl_stmt>    <comment type="line">// Counter for life of missle.</comment>

  <comment type="line">// Asteroid data.</comment>

  <decl_stmt><decl><type><name><name>boolean</name><index>[]</index></name></type> <name>asteroidIsSmall</name> <init>= <expr><operator>new</operator> <name><name>boolean</name><index>[<expr><name>MAX_ROCKS</name></expr>]</index></name></expr></init></decl>;</decl_stmt>    <comment type="line">// Asteroid size flag.</comment>
  <decl_stmt><decl><type><name>int</name></type>       <name>asteroidsCounter</name></decl>;</decl_stmt>                            <comment type="line">// Break-time counter.</comment>
  <decl_stmt><decl><type><name>double</name></type>    <name>asteroidsSpeed</name></decl>;</decl_stmt>                              <comment type="line">// Asteroid speed.</comment>
  <decl_stmt><decl><type><name>int</name></type>       <name>asteroidsLeft</name></decl>;</decl_stmt>                               <comment type="line">// Number of active asteroids.</comment>

  <comment type="line">// Explosion data.</comment>

  <decl_stmt><decl><type><name><name>int</name><index>[]</index></name></type> <name>explosionCounter</name> <init>= <expr><operator>new</operator> <name><name>int</name><index>[<expr><name>MAX_SCRAP</name></expr>]</index></name></expr></init></decl>;</decl_stmt>  <comment type="line">// Time counters for explosions.</comment>
  <decl_stmt><decl><type><name>int</name></type>   <name>explosionIndex</name></decl>;</decl_stmt>                         <comment type="line">// Next available explosion sprite.</comment>

  <comment type="line">// Sound clips.</comment>

  <decl_stmt><decl><type><name>AudioClip</name></type> <name>crashSound</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>AudioClip</name></type> <name>explosionSound</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>AudioClip</name></type> <name>fireSound</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>AudioClip</name></type> <name>missleSound</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>AudioClip</name></type> <name>saucerSound</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>AudioClip</name></type> <name>thrustersSound</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>AudioClip</name></type> <name>warpSound</name></decl>;</decl_stmt>

  <comment type="line">// Flags for looping sound clips.</comment>

  <decl_stmt><decl><type><name>boolean</name></type> <name>thrustersPlaying</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>boolean</name></type> <name>saucerPlaying</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>boolean</name></type> <name>misslePlaying</name></decl>;</decl_stmt>

  <comment type="line">// Counter and total used to track the loading of the sound clips.</comment>

  <decl_stmt><decl><type><name>int</name></type> <name>clipTotal</name>   <init>= <expr><literal type="number">0</literal></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>int</name></type> <name>clipsLoaded</name> <init>= <expr><literal type="number">0</literal></expr></init></decl>;</decl_stmt>

  <comment type="line">// Off screen image.</comment>

  <decl_stmt><decl><type><name>Dimension</name></type> <name>offDimension</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>Image</name></type>     <name>offImage</name></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>Graphics</name></type>  <name>offGraphics</name></decl>;</decl_stmt>

  <comment type="line">// Data for the screen font.</comment>

  <decl_stmt><decl><type><name>Font</name></type> <name>font</name>      <init>= <expr><operator>new</operator> <call><name>Font</name><argument_list>(<argument><expr><literal type="string">"Helvetica"</literal></expr></argument>, <argument><expr><name><name>Font</name><operator>.</operator><name>BOLD</name></name></expr></argument>, <argument><expr><literal type="number">12</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>FontMetrics</name></type> <name>fm</name> <init>= <expr><call><name>getFontMetrics</name><argument_list>(<argument><expr><name>font</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>int</name></type> <name>fontWidth</name>  <init>= <expr><call><name><name>fm</name><operator>.</operator><name>getMaxAdvance</name></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
  <decl_stmt><decl><type><name>int</name></type> <name>fontHeight</name> <init>= <expr><call><name><name>fm</name><operator>.</operator><name>getHeight</name></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>

  <function><specifier>public</specifier> <type><name>String</name></type> <name>getAppletInfo</name><parameter_list>()</parameter_list> <block>{

    <comment type="line">// Return copyright information.</comment>

    <return>return<expr><operator>(</operator><name>copyText</name><operator>)</operator></expr>;</return>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>init</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>Dimension</name></type> <name>d</name> <init>= <expr><call><name>getSize</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>;</decl_stmt>

    <comment type="line">// Display copyright information.</comment>

    <expr_stmt><expr><call><name><name>System</name><operator>.</operator><name>out</name><operator>.</operator><name>println</name></name><argument_list>(<argument><expr><name>copyText</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <comment type="line">// Set up key event handling and set focus to applet window.</comment>

    <expr_stmt><expr><call><name>addKeyListener</name><argument_list>(<argument><expr><name>this</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name>requestFocus</name><argument_list>()</argument_list></call></expr>;</expr_stmt>

    <comment type="line">// Save the screen size.</comment>

    <expr_stmt><expr><name><name>AsteroidsSprite</name><operator>.</operator><name>width</name></name> <operator>=</operator> <name><name>d</name><operator>.</operator><name>width</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>AsteroidsSprite</name><operator>.</operator><name>height</name></name> <operator>=</operator> <name><name>d</name><operator>.</operator><name>height</name></name></expr>;</expr_stmt>

    <comment type="line">// Generate the starry background.</comment>

    <expr_stmt><expr><name>numStars</name> <operator>=</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>width</name></name> <operator>*</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>height</name></name> <operator>/</operator> <literal type="number">5000</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>stars</name> <operator>=</operator> <operator>new</operator> <name><name>Point</name><index>[<expr><name>numStars</name></expr>]</index></name></expr>;</expr_stmt>
    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>numStars</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
      <block type="pseudo"><expr_stmt><expr><name><name>stars</name><index>[<expr><name>i</name></expr>]</index></name> <operator>=</operator> <operator>new</operator> <call><name>Point</name><argument_list>(<argument><expr><call>(<name>int</name>) <argument_list>(<argument><expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>width</name></name></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><call>(<name>int</name>) <argument_list>(<argument><expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>height</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt></block></for>

    <comment type="line">// Create shape for the ship sprite.</comment>

    <expr_stmt><expr><name>ship</name> <operator>=</operator> <operator>new</operator> <call><name>AsteroidsSprite</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ship</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><operator>-</operator><literal type="number">10</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ship</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">7</literal></expr></argument>, <argument><expr><literal type="number">10</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ship</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">7</literal></expr></argument>, <argument><expr><literal type="number">10</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <comment type="line">// Create shapes for the ship thrusters.</comment>

    <expr_stmt><expr><name>fwdThruster</name> <operator>=</operator> <operator>new</operator> <call><name>AsteroidsSprite</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>fwdThruster</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><literal type="number">12</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>fwdThruster</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">3</literal></expr></argument>, <argument><expr><literal type="number">16</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>fwdThruster</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><literal type="number">26</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>fwdThruster</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">3</literal></expr></argument>, <argument><expr><literal type="number">16</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><name>revThruster</name> <operator>=</operator> <operator>new</operator> <call><name>AsteroidsSprite</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>revThruster</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">2</literal></expr></argument>, <argument><expr><literal type="number">12</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>revThruster</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">4</literal></expr></argument>, <argument><expr><literal type="number">14</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>revThruster</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">2</literal></expr></argument>, <argument><expr><literal type="number">20</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>revThruster</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><literal type="number">14</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>revThruster</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">2</literal></expr></argument>, <argument><expr><literal type="number">12</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>revThruster</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">4</literal></expr></argument>, <argument><expr><literal type="number">14</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>revThruster</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">2</literal></expr></argument>, <argument><expr><literal type="number">20</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>revThruster</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><literal type="number">14</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <comment type="line">// Create shape for each photon sprites.</comment>

    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_SHOTS</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control> <block>{
      <expr_stmt><expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name> <operator>=</operator> <operator>new</operator> <call><name>AsteroidsSprite</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><operator>-</operator><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">1</literal></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">1</literal></expr></argument>, <argument><expr><operator>-</operator><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    }</block></for>

    <comment type="line">// Create shape for the flying saucer.</comment>

    <expr_stmt><expr><name>ufo</name> <operator>=</operator> <operator>new</operator> <call><name>AsteroidsSprite</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">15</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">10</literal></expr></argument>, <argument><expr><operator>-</operator><literal type="number">5</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">5</literal></expr></argument>, <argument><expr><operator>-</operator><literal type="number">5</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">5</literal></expr></argument>, <argument><expr><operator>-</operator><literal type="number">8</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">5</literal></expr></argument>, <argument><expr><operator>-</operator><literal type="number">8</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">5</literal></expr></argument>, <argument><expr><operator>-</operator><literal type="number">5</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">10</literal></expr></argument>, <argument><expr><operator>-</operator><literal type="number">5</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">15</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">10</literal></expr></argument>, <argument><expr><literal type="number">5</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">10</literal></expr></argument>, <argument><expr><literal type="number">5</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <comment type="line">// Create shape for the guided missle.</comment>

    <expr_stmt><expr><name>missle</name> <operator>=</operator> <operator>new</operator> <call><name>AsteroidsSprite</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>missle</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><operator>-</operator><literal type="number">4</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>missle</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><operator>-</operator><literal type="number">3</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>missle</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><literal type="number">3</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>missle</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><literal type="number">2</literal></expr></argument>, <argument><expr><literal type="number">4</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>missle</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">2</literal></expr></argument>, <argument><expr><literal type="number">4</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>missle</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">1</literal></expr></argument>, <argument><expr><literal type="number">3</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>missle</name><operator>.</operator><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><operator>-</operator><literal type="number">1</literal></expr></argument>, <argument><expr><operator>-</operator><literal type="number">3</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <comment type="line">// Create asteroid sprites.</comment>

    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_ROCKS</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
      <block type="pseudo"><expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name> <operator>=</operator> <operator>new</operator> <call><name>AsteroidsSprite</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></for>

    <comment type="line">// Create explosion sprites.</comment>

    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_SCRAP</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
      <block type="pseudo"><expr_stmt><expr><name><name>explosions</name><index>[<expr><name>i</name></expr>]</index></name> <operator>=</operator> <operator>new</operator> <call><name>AsteroidsSprite</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></for>

    <comment type="line">// Initialize game data and put us in 'game over' mode.</comment>

    <expr_stmt><expr><name>highScore</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>sound</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>detail</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
    <expr_stmt><expr><call><name>initGame</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name>endGame</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>initGame</name><parameter_list>()</parameter_list> <block>{

    <comment type="line">// Initialize game data and sprites.</comment>

    <expr_stmt><expr><name>score</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>shipsLeft</name> <operator>=</operator> <name>MAX_SHIPS</name></expr>;</expr_stmt>
    <expr_stmt><expr><name>asteroidsSpeed</name> <operator>=</operator> <name>MIN_ROCK_SPEED</name></expr>;</expr_stmt>
    <expr_stmt><expr><name>newShipScore</name> <operator>=</operator> <name>NEW_SHIP_POINTS</name></expr>;</expr_stmt>
    <expr_stmt><expr><name>newUfoScore</name> <operator>=</operator> <name>NEW_UFO_POINTS</name></expr>;</expr_stmt>
    <expr_stmt><expr><call><name>initShip</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name>initPhotons</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name>stopUfo</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name>stopMissle</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name>initAsteroids</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name>initExplosions</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><name>playing</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>paused</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>photonTime</name> <operator>=</operator> <call><name><name>System</name><operator>.</operator><name>currentTimeMillis</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>endGame</name><parameter_list>()</parameter_list> <block>{

    <comment type="line">// Stop ship, flying saucer, guided missle and associated sounds.</comment>

    <expr_stmt><expr><name>playing</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
    <expr_stmt><expr><call><name>stopShip</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name>stopUfo</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name>stopMissle</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>start</name><parameter_list>()</parameter_list> <block>{

    <if>if <condition>(<expr><name>loopThread</name> <operator>==</operator> <literal type="null">null</literal></expr>)</condition><then> <block>{
      <expr_stmt><expr><name>loopThread</name> <operator>=</operator> <operator>new</operator> <call><name>Thread</name><argument_list>(<argument><expr><name>this</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>loopThread</name><operator>.</operator><name>start</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    }</block></then></if>
    <if>if <condition>(<expr><operator>!</operator><name>loaded</name> <operator>&amp;&amp;</operator> <name>loadThread</name> <operator>==</operator> <literal type="null">null</literal></expr>)</condition><then> <block>{
      <expr_stmt><expr><name>loadThread</name> <operator>=</operator> <operator>new</operator> <call><name>Thread</name><argument_list>(<argument><expr><name>this</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>loadThread</name><operator>.</operator><name>start</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    }</block></then></if>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>stop</name><parameter_list>()</parameter_list> <block>{

    <if>if <condition>(<expr><name>loopThread</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition><then> <block>{
      <expr_stmt><expr><call><name><name>loopThread</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>loopThread</name> <operator>=</operator> <literal type="null">null</literal></expr>;</expr_stmt>
    }</block></then></if>
    <if>if <condition>(<expr><name>loadThread</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition><then> <block>{
      <expr_stmt><expr><call><name><name>loadThread</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>loadThread</name> <operator>=</operator> <literal type="null">null</literal></expr>;</expr_stmt>
    }</block></then></if>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>run</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>, <decl><type ref="prev"/><name>j</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>long</name></type> <name>startTime</name></decl>;</decl_stmt>

    <comment type="line">// Lower this thread's priority and get the current time.</comment>

    <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>setPriority</name><argument_list>(<argument><expr><name><name>Thread</name><operator>.</operator><name>MIN_PRIORITY</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><name>startTime</name> <operator>=</operator> <call><name><name>System</name><operator>.</operator><name>currentTimeMillis</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>

    <comment type="line">// Run thread for loading sounds.</comment>

    <if>if <condition>(<expr><operator>!</operator><name>loaded</name> <operator>&amp;&amp;</operator> <call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name>loadThread</name></expr>)</condition><then> <block>{
      <expr_stmt><expr><call><name>loadSounds</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>loaded</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>loadThread</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    }</block></then></if>

    <comment type="line">// This is the main loop.</comment>

    <while>while <condition>(<expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name>loopThread</name></expr>)</condition> <block>{

      <if>if <condition>(<expr><operator>!</operator><name>paused</name></expr>)</condition><then> <block>{

        <comment type="line">// Move and process all sprites.</comment>

        <expr_stmt><expr><call><name>updateShip</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>updatePhotons</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>updateUfo</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>updateMissle</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>updateAsteroids</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>updateExplosions</name><argument_list>()</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// Check the score and advance high score, add a new ship or start the</comment>
        <comment type="line">// flying saucer as necessary.</comment>

        <if>if <condition>(<expr><name>score</name> <operator>&gt;</operator> <name>highScore</name></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><name>highScore</name> <operator>=</operator> <name>score</name></expr>;</expr_stmt></block></then></if>
        <if>if <condition>(<expr><name>score</name> <operator>&gt;</operator> <name>newShipScore</name></expr>)</condition><then> <block>{
          <expr_stmt><expr><name>newShipScore</name> <operator>+=</operator> <name>NEW_SHIP_POINTS</name></expr>;</expr_stmt>
          <expr_stmt><expr><name>shipsLeft</name><operator>++</operator></expr>;</expr_stmt>
        }</block></then></if>
        <if>if <condition>(<expr><name>playing</name> <operator>&amp;&amp;</operator> <name>score</name> <operator>&gt;</operator> <name>newUfoScore</name> <operator>&amp;&amp;</operator> <operator>!</operator><name><name>ufo</name><operator>.</operator><name>active</name></name></expr>)</condition><then> <block>{
          <expr_stmt><expr><name>newUfoScore</name> <operator>+=</operator> <name>NEW_UFO_POINTS</name></expr>;</expr_stmt>
          <expr_stmt><expr><name>ufoPassesLeft</name> <operator>=</operator> <name>UFO_PASSES</name></expr>;</expr_stmt>
          <expr_stmt><expr><call><name>initUfo</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        }</block></then></if>

        <comment type="line">// If all asteroids have been destroyed create a new batch.</comment>

        <if>if <condition>(<expr><name>asteroidsLeft</name> <operator>&lt;=</operator> <literal type="number">0</literal></expr>)</condition><then>
            <block type="pseudo"><if>if <condition>(<expr><operator>--</operator><name>asteroidsCounter</name> <operator>&lt;=</operator> <literal type="number">0</literal></expr>)</condition><then>
              <block type="pseudo"><expr_stmt><expr><call><name>initAsteroids</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if></block></then></if>
      }</block></then></if>

      <comment type="line">// Update the screen and set the timer for the next loop.</comment>

      <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <try>try <block>{
        <expr_stmt><expr><name>startTime</name> <operator>+=</operator> <name>DELAY</name></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>sleep</name></name><argument_list>(<argument><expr><call><name><name>Math</name><operator>.</operator><name>max</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><name>startTime</name> <operator>-</operator> <call><name><name>System</name><operator>.</operator><name>currentTimeMillis</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      }</block>
      <catch>catch <parameter_list>(<parameter><decl><type><name>InterruptedException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{
        <break>break;</break>
      }</block></catch></try>
    }</block></while>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>loadSounds</name><parameter_list>()</parameter_list> <block>{

    <comment type="line">// Load all sound clips by playing and immediately stopping them. Update</comment>
    <comment type="line">// counter and total for display.</comment>

    <try>try <block>{
      <expr_stmt><expr><name>crashSound</name>     <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"crash.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
      <expr_stmt><expr><name>explosionSound</name> <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"explosion.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
      <expr_stmt><expr><name>fireSound</name>      <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"fire.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
      <expr_stmt><expr><name>missleSound</name>    <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"missle.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
      <expr_stmt><expr><name>saucerSound</name>    <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"saucer.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
      <expr_stmt><expr><name>thrustersSound</name> <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"thrusters.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
      <expr_stmt><expr><name>warpSound</name>      <operator>=</operator> <call><name>getAudioClip</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><call><name>getCodeBase</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"warp.au"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>clipTotal</name><operator>++</operator></expr>;</expr_stmt>
    }</block>
    <catch>catch <parameter_list>(<parameter><decl><type><name>MalformedURLException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{}</block></catch></try>

    <try>try <block>{
      <expr_stmt><expr><call><name><name>crashSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>     <expr_stmt><expr><call><name><name>crashSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>     <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
      <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>explosionSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>explosionSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
      <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>fireSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>      <expr_stmt><expr><call><name><name>fireSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>      <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
      <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>missleSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>    <expr_stmt><expr><call><name><name>missleSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>    <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
      <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>saucerSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>    <expr_stmt><expr><call><name><name>saucerSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>    <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
      <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>thrustersSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>thrustersSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
      <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>warpSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>      <expr_stmt><expr><call><name><name>warpSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>      <expr_stmt><expr><name>clipsLoaded</name><operator>++</operator></expr>;</expr_stmt>
      <expr_stmt><expr><call><name>repaint</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <expr_stmt><expr><call><name><name>Thread</name><operator>.</operator><name>currentThread</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>sleep</name><argument_list>(<argument><expr><name>DELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    }</block>
    <catch>catch <parameter_list>(<parameter><decl><type><name>InterruptedException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{}</block></catch></try>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>initShip</name><parameter_list>()</parameter_list> <block>{

    <comment type="line">// Reset the ship sprite at the center of the screen.</comment>

    <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>active</name></name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>deltaAngle</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>x</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>y</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>deltaX</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>deltaY</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>ship</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>

    <comment type="line">// Initialize thruster sprites.</comment>

    <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>x</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>x</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>y</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>y</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>angle</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>fwdThruster</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>x</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>x</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>y</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>y</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>angle</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>revThruster</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>

    <if>if <condition>(<expr><name>loaded</name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><call><name><name>thrustersSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
    <expr_stmt><expr><name>thrustersPlaying</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>hyperCounter</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>updateShip</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>double</name></type> <name>dx</name></decl>, <decl><type ref="prev"/><name>dy</name></decl>, <decl><type ref="prev"/><name>speed</name></decl>;</decl_stmt>

    <if>if <condition>(<expr><operator>!</operator><name>playing</name></expr>)</condition><then>
      <block type="pseudo"><return>return;</return></block></then></if>

    <comment type="line">// Rotate the ship if left or right cursor key is down.</comment>

    <if>if <condition>(<expr><name>left</name></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>angle</name></name> <operator>+=</operator> <name>SHIP_ANGLE_STEP</name></expr>;</expr_stmt>
      <if>if <condition>(<expr><name><name>ship</name><operator>.</operator><name>angle</name></name> <operator>&gt;</operator> <literal type="number">2</literal> <operator>*</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><name><name>ship</name><operator>.</operator><name>angle</name></name> <operator>-=</operator> <literal type="number">2</literal> <operator>*</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name></expr>;</expr_stmt></block></then></if>
    }</block></then></if>
    <if>if <condition>(<expr><name>right</name></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>angle</name></name> <operator>-=</operator> <name>SHIP_ANGLE_STEP</name></expr>;</expr_stmt>
      <if>if <condition>(<expr><name><name>ship</name><operator>.</operator><name>angle</name></name> <operator>&lt;</operator> <literal type="number">0</literal></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><name><name>ship</name><operator>.</operator><name>angle</name></name> <operator>+=</operator> <literal type="number">2</literal> <operator>*</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name></expr>;</expr_stmt></block></then></if>
    }</block></then></if>

    <comment type="line">// Fire thrusters if up or down cursor key is down.</comment>

    <expr_stmt><expr><name>dx</name> <operator>=</operator> <name>SHIP_SPEED_STEP</name> <operator>*</operator> <operator>-</operator><call><name><name>Math</name><operator>.</operator><name>sin</name></name><argument_list>(<argument><expr><name><name>ship</name><operator>.</operator><name>angle</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><name>dy</name> <operator>=</operator> <name>SHIP_SPEED_STEP</name> <operator>*</operator>  <call><name><name>Math</name><operator>.</operator><name>cos</name></name><argument_list>(<argument><expr><name><name>ship</name><operator>.</operator><name>angle</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <if>if <condition>(<expr><name>up</name></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>deltaX</name></name> <operator>+=</operator> <name>dx</name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>deltaY</name></name> <operator>+=</operator> <name>dy</name></expr>;</expr_stmt>
    }</block></then></if>
    <if>if <condition>(<expr><name>down</name></expr>)</condition><then> <block>{
        <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>deltaX</name></name> <operator>-=</operator> <name>dx</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>deltaY</name></name> <operator>-=</operator> <name>dy</name></expr>;</expr_stmt>
    }</block></then></if>

    <comment type="line">// Don't let ship go past the speed limit.</comment>

    <if>if <condition>(<expr><name>up</name> <operator>||</operator> <name>down</name></expr>)</condition><then> <block>{
      <expr_stmt><expr><name>speed</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>sqrt</name></name><argument_list>(<argument><expr><name><name>ship</name><operator>.</operator><name>deltaX</name></name> <operator>*</operator> <name><name>ship</name><operator>.</operator><name>deltaX</name></name> <operator>+</operator> <name><name>ship</name><operator>.</operator><name>deltaY</name></name> <operator>*</operator> <name><name>ship</name><operator>.</operator><name>deltaY</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <if>if <condition>(<expr><name>speed</name> <operator>&gt;</operator> <name>MAX_SHIP_SPEED</name></expr>)</condition><then> <block>{
        <expr_stmt><expr><name>dx</name> <operator>=</operator> <name>MAX_SHIP_SPEED</name> <operator>*</operator> <operator>-</operator><call><name><name>Math</name><operator>.</operator><name>sin</name></name><argument_list>(<argument><expr><name><name>ship</name><operator>.</operator><name>angle</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>dy</name> <operator>=</operator> <name>MAX_SHIP_SPEED</name> <operator>*</operator>  <call><name><name>Math</name><operator>.</operator><name>cos</name></name><argument_list>(<argument><expr><name><name>ship</name><operator>.</operator><name>angle</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <if>if <condition>(<expr><name>up</name></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><name><name>ship</name><operator>.</operator><name>deltaX</name></name> <operator>=</operator> <name>dx</name></expr>;</expr_stmt></block></then>
        <else>else
          <block type="pseudo"><expr_stmt><expr><name><name>ship</name><operator>.</operator><name>deltaX</name></name> <operator>=</operator> <operator>-</operator><name>dx</name></expr>;</expr_stmt></block></else></if>
        <if>if <condition>(<expr><name>up</name></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><name><name>ship</name><operator>.</operator><name>deltaY</name></name> <operator>=</operator> <name>dy</name></expr>;</expr_stmt></block></then>
        <else>else
          <block type="pseudo"><expr_stmt><expr><name><name>ship</name><operator>.</operator><name>deltaY</name></name> <operator>=</operator> <operator>-</operator><name>dy</name></expr>;</expr_stmt></block></else></if>
      }</block></then></if>
    }</block></then></if>

    <comment type="line">// Move the ship. If it is currently in hyperspace, advance the countdown.</comment>

    <if>if <condition>(<expr><name><name>ship</name><operator>.</operator><name>active</name></name></expr>)</condition><then> <block>{
      <expr_stmt><expr><call><name><name>ship</name><operator>.</operator><name>advance</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>ship</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <if>if <condition>(<expr><name>hyperCounter</name> <operator>&gt;</operator> <literal type="number">0</literal></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><name>hyperCounter</name><operator>--</operator></expr>;</expr_stmt></block></then></if>

      <comment type="line">// Update the thruster sprites to match the ship sprite.</comment>

      <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>x</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>x</name></name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>y</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>y</name></name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>fwdThruster</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>angle</name></name></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>fwdThruster</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>x</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>x</name></name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>y</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>y</name></name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>revThruster</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>angle</name></name></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>revThruster</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    }</block></then>

    <comment type="line">// Ship is exploding, advance the countdown or create a new ship if it is</comment>
    <comment type="line">// done exploding. The new ship is added as though it were in hyperspace.</comment>
    <comment type="line">// (This gives the player time to move the ship if it is in imminent</comment>
    <comment type="line">// danger.) If that was the last ship, end the game.</comment>

    <elseif>else
      <if>if <condition>(<expr><operator>--</operator><name>shipCounter</name> <operator>&lt;=</operator> <literal type="number">0</literal></expr>)</condition><then>
        <block type="pseudo"><if>if <condition>(<expr><name>shipsLeft</name> <operator>&gt;</operator> <literal type="number">0</literal></expr>)</condition><then> <block>{
          <expr_stmt><expr><call><name>initShip</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><name>hyperCounter</name> <operator>=</operator> <name>HYPER_COUNT</name></expr>;</expr_stmt>
        }</block></then>
        <else>else
          <block type="pseudo"><expr_stmt><expr><call><name>endGame</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></else></if></block></then></if></elseif></if>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>stopShip</name><parameter_list>()</parameter_list> <block>{

    <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>active</name></name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>shipCounter</name> <operator>=</operator> <name>SCRAP_COUNT</name></expr>;</expr_stmt>
    <if>if <condition>(<expr><name>shipsLeft</name> <operator>&gt;</operator> <literal type="number">0</literal></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name>shipsLeft</name><operator>--</operator></expr>;</expr_stmt></block></then></if>
    <if>if <condition>(<expr><name>loaded</name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><call><name><name>thrustersSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
    <expr_stmt><expr><name>thrustersPlaying</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>initPhotons</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>;</decl_stmt>

    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_SHOTS</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
      <block type="pseudo"><expr_stmt><expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt></block></for>
    <expr_stmt><expr><name>photonIndex</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>updatePhotons</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>;</decl_stmt>

    <comment type="line">// Move any active photons. Stop it when its counter has expired.</comment>

    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_SHOTS</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
      <block type="pseudo"><if>if <condition>(<expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name></expr>)</condition><then> <block>{
        <if>if <condition>(<expr><operator>!</operator><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name>advance</name><argument_list>()</argument_list></call></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name>render</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then>
        <else>else
          <block type="pseudo"><expr_stmt><expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt></block></else></if>
      }</block></then></if></block></for>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>initUfo</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>double</name></type> <name>angle</name></decl>, <decl><type ref="prev"/><name>speed</name></decl>;</decl_stmt>

    <comment type="line">// Randomly set flying saucer at left or right edge of the screen.</comment>

    <expr_stmt><expr><name><name>ufo</name><operator>.</operator><name>active</name></name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>ufo</name><operator>.</operator><name>x</name></name> <operator>=</operator> <operator>-</operator><name><name>AsteroidsSprite</name><operator>.</operator><name>width</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>ufo</name><operator>.</operator><name>y</name></name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <literal type="number">2</literal> <operator>*</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>height</name></name> <operator>-</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>height</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><name>angle</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>/</operator> <literal type="number">4</literal> <operator>-</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>speed</name> <operator>=</operator> <name>MAX_ROCK_SPEED</name> <operator>/</operator> <literal type="number">2</literal> <operator>+</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <operator>(</operator><name>MAX_ROCK_SPEED</name> <operator>/</operator> <literal type="number">2</literal><operator>)</operator></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>ufo</name><operator>.</operator><name>deltaX</name></name> <operator>=</operator> <name>speed</name> <operator>*</operator> <operator>-</operator><call><name><name>Math</name><operator>.</operator><name>sin</name></name><argument_list>(<argument><expr><name>angle</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>ufo</name><operator>.</operator><name>deltaY</name></name> <operator>=</operator> <name>speed</name> <operator>*</operator>  <call><name><name>Math</name><operator>.</operator><name>cos</name></name><argument_list>(<argument><expr><name>angle</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <if>if <condition>(<expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>&lt;</operator> <literal type="number">0.5</literal></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>ufo</name><operator>.</operator><name>x</name></name> <operator>=</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>width</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>ufo</name><operator>.</operator><name>deltaX</name></name> <operator>=</operator> <operator>-</operator><name><name>ufo</name><operator>.</operator><name>deltaX</name></name></expr>;</expr_stmt>
    }</block></then></if>
    <if>if <condition>(<expr><name><name>ufo</name><operator>.</operator><name>y</name></name> <operator>&gt;</operator> <literal type="number">0</literal></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name><name>ufo</name><operator>.</operator><name>deltaY</name></name> <operator>=</operator> <name><name>ufo</name><operator>.</operator><name>deltaY</name></name></expr>;</expr_stmt></block></then></if>
    <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><name>saucerPlaying</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
    <if>if <condition>(<expr><name>sound</name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><call><name><name>saucerSound</name><operator>.</operator><name>loop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
    <expr_stmt><expr><name>ufoCounter</name> <operator>=</operator> <operator>(</operator><name>int</name><operator>)</operator> <call><name><name>Math</name><operator>.</operator><name>abs</name></name><argument_list>(<argument><expr><name><name>AsteroidsSprite</name><operator>.</operator><name>width</name></name> <operator>/</operator> <name><name>ufo</name><operator>.</operator><name>deltaX</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>updateUfo</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>, <decl><type ref="prev"/><name>d</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>boolean</name></type> <name>wrapped</name></decl>;</decl_stmt>

    <comment type="line">// Move the flying saucer and check for collision with a photon. Stop it</comment>
    <comment type="line">// when its counter has expired.</comment>

    <if>if <condition>(<expr><name><name>ufo</name><operator>.</operator><name>active</name></name></expr>)</condition><then> <block>{
      <if>if <condition>(<expr><operator>--</operator><name>ufoCounter</name> <operator>&lt;=</operator> <literal type="number">0</literal></expr>)</condition><then> <block>{
        <if>if <condition>(<expr><operator>--</operator><name>ufoPassesLeft</name> <operator>&gt;</operator> <literal type="number">0</literal></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><call><name>initUfo</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then>
        <else>else
          <block type="pseudo"><expr_stmt><expr><call><name>stopUfo</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></else></if>
      }</block></then></if>
      <if>if <condition>(<expr><name><name>ufo</name><operator>.</operator><name>active</name></name></expr>)</condition><then> <block>{
        <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>advance</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>ufo</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_SHOTS</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
          <block type="pseudo"><if>if <condition>(<expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>&amp;&amp;</operator> <call><name><name>ufo</name><operator>.</operator><name>isColliding</name></name><argument_list>(<argument><expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
            <if>if <condition>(<expr><name>sound</name></expr>)</condition><then>
              <block type="pseudo"><expr_stmt><expr><call><name><name>crashSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
            <expr_stmt><expr><call><name>explode</name><argument_list>(<argument><expr><name>ufo</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>stopUfo</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>score</name> <operator>+=</operator> <name>UFO_POINTS</name></expr>;</expr_stmt>
          }</block></then></if></block></for>

          <comment type="line">// On occassion, fire a missle at the ship if the saucer is not too</comment>
          <comment type="line">// close to it.</comment>

          <expr_stmt><expr><name>d</name> <operator>=</operator> <operator>(</operator><name>int</name><operator>)</operator> <call><name><name>Math</name><operator>.</operator><name>max</name></name><argument_list>(<argument><expr><call><name><name>Math</name><operator>.</operator><name>abs</name></name><argument_list>(<argument><expr><name><name>ufo</name><operator>.</operator><name>x</name></name> <operator>-</operator> <name><name>ship</name><operator>.</operator><name>x</name></name></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><call><name><name>Math</name><operator>.</operator><name>abs</name></name><argument_list>(<argument><expr><name><name>ufo</name><operator>.</operator><name>y</name></name> <operator>-</operator> <name><name>ship</name><operator>.</operator><name>y</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
          <if>if <condition>(<expr><name><name>ship</name><operator>.</operator><name>active</name></name> <operator>&amp;&amp;</operator> <name>hyperCounter</name> <operator>&lt;=</operator> <literal type="number">0</literal> <operator>&amp;&amp;</operator>
              <name><name>ufo</name><operator>.</operator><name>active</name></name> <operator>&amp;&amp;</operator> <operator>!</operator><name><name>missle</name><operator>.</operator><name>active</name></name> <operator>&amp;&amp;</operator>
              <name>d</name> <operator>&gt;</operator> <name>MAX_ROCK_SPEED</name> <operator>*</operator> <name>FPS</name> <operator>/</operator> <literal type="number">2</literal> <operator>&amp;&amp;</operator>
              <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>&lt;</operator> <name>MISSLE_PROBABILITY</name></expr>)</condition><then>
            <block type="pseudo"><expr_stmt><expr><call><name>initMissle</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
       }</block></then></if>
    }</block></then></if>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>stopUfo</name><parameter_list>()</parameter_list> <block>{

    <expr_stmt><expr><name><name>ufo</name><operator>.</operator><name>active</name></name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>ufoCounter</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>ufoPassesLeft</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt>
    <if>if <condition>(<expr><name>loaded</name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><call><name><name>saucerSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
    <expr_stmt><expr><name>saucerPlaying</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>initMissle</name><parameter_list>()</parameter_list> <block>{

    <expr_stmt><expr><name><name>missle</name><operator>.</operator><name>active</name></name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>missle</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>missle</name><operator>.</operator><name>deltaAngle</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>missle</name><operator>.</operator><name>x</name></name> <operator>=</operator> <name><name>ufo</name><operator>.</operator><name>x</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>missle</name><operator>.</operator><name>y</name></name> <operator>=</operator> <name><name>ufo</name><operator>.</operator><name>y</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>missle</name><operator>.</operator><name>deltaX</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>missle</name><operator>.</operator><name>deltaY</name></name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>missle</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><name>missleCounter</name> <operator>=</operator> <name>MISSLE_COUNT</name></expr>;</expr_stmt>
    <if>if <condition>(<expr><name>sound</name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><call><name><name>missleSound</name><operator>.</operator><name>loop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
    <expr_stmt><expr><name>misslePlaying</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>updateMissle</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>;</decl_stmt>

    <comment type="line">// Move the guided missle and check for collision with ship or photon. Stop</comment>
    <comment type="line">// it when its counter has expired.</comment>

    <if>if <condition>(<expr><name><name>missle</name><operator>.</operator><name>active</name></name></expr>)</condition><then> <block>{
      <if>if <condition>(<expr><operator>--</operator><name>missleCounter</name> <operator>&lt;=</operator> <literal type="number">0</literal></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><call><name>stopMissle</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then>
      <else>else <block>{
        <expr_stmt><expr><call><name>guideMissle</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>missle</name><operator>.</operator><name>advance</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>missle</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_SHOTS</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
          <block type="pseudo"><if>if <condition>(<expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>&amp;&amp;</operator> <call><name><name>missle</name><operator>.</operator><name>isColliding</name></name><argument_list>(<argument><expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
            <if>if <condition>(<expr><name>sound</name></expr>)</condition><then>
              <block type="pseudo"><expr_stmt><expr><call><name><name>crashSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
            <expr_stmt><expr><call><name>explode</name><argument_list>(<argument><expr><name>missle</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>stopMissle</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>score</name> <operator>+=</operator> <name>MISSLE_POINTS</name></expr>;</expr_stmt>
          }</block></then></if></block></for>
        <if>if <condition>(<expr><name><name>missle</name><operator>.</operator><name>active</name></name> <operator>&amp;&amp;</operator> <name><name>ship</name><operator>.</operator><name>active</name></name> <operator>&amp;&amp;</operator>
            <name>hyperCounter</name> <operator>&lt;=</operator> <literal type="number">0</literal> <operator>&amp;&amp;</operator> <call><name><name>ship</name><operator>.</operator><name>isColliding</name></name><argument_list>(<argument><expr><name>missle</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
          <if>if <condition>(<expr><name>sound</name></expr>)</condition><then>
            <block type="pseudo"><expr_stmt><expr><call><name><name>crashSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
          <expr_stmt><expr><call><name>explode</name><argument_list>(<argument><expr><name>ship</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><call><name>stopShip</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><call><name>stopUfo</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><call><name>stopMissle</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        }</block></then></if>
      }</block></else></if>
    }</block></then></if>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>guideMissle</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>double</name></type> <name>dx</name></decl>, <decl><type ref="prev"/><name>dy</name></decl>, <decl><type ref="prev"/><name>angle</name></decl>;</decl_stmt>

    <if>if <condition>(<expr><operator>!</operator><name><name>ship</name><operator>.</operator><name>active</name></name> <operator>||</operator> <name>hyperCounter</name> <operator>&gt;</operator> <literal type="number">0</literal></expr>)</condition><then>
      <block type="pseudo"><return>return;</return></block></then></if>

    <comment type="line">// Find the angle needed to hit the ship.</comment>

    <expr_stmt><expr><name>dx</name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>x</name></name> <operator>-</operator> <name><name>missle</name><operator>.</operator><name>x</name></name></expr>;</expr_stmt>
    <expr_stmt><expr><name>dy</name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>y</name></name> <operator>-</operator> <name><name>missle</name><operator>.</operator><name>y</name></name></expr>;</expr_stmt>
    <if>if <condition>(<expr><name>dx</name> <operator>==</operator> <literal type="number">0</literal> <operator>&amp;&amp;</operator> <name>dy</name> <operator>==</operator> <literal type="number">0</literal></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name>angle</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt></block></then></if>
    <if>if <condition>(<expr><name>dx</name> <operator>==</operator> <literal type="number">0</literal></expr>)</condition><then> <block>{
      <if>if <condition>(<expr><name>dy</name> <operator>&lt;</operator> <literal type="number">0</literal></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><name>angle</name> <operator>=</operator> <operator>-</operator><name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt></block></then>
      <else>else
        <block type="pseudo"><expr_stmt><expr><name>angle</name> <operator>=</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt></block></else></if>
    }</block></then>
    <else>else <block>{
      <expr_stmt><expr><name>angle</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>atan</name></name><argument_list>(<argument><expr><call><name><name>Math</name><operator>.</operator><name>abs</name></name><argument_list>(<argument><expr><name>dy</name> <operator>/</operator> <name>dx</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <if>if <condition>(<expr><name>dy</name> <operator>&gt;</operator> <literal type="number">0</literal></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><name>angle</name> <operator>=</operator> <operator>-</operator><name>angle</name></expr>;</expr_stmt></block></then></if>
      <if>if <condition>(<expr><name>dx</name> <operator>&lt;</operator> <literal type="number">0</literal></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><name>angle</name> <operator>=</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>-</operator> <name>angle</name></expr>;</expr_stmt></block></then></if>
    }</block></else></if>

    <comment type="line">// Adjust angle for screen coordinates.</comment>

    <expr_stmt><expr><name><name>missle</name><operator>.</operator><name>angle</name></name> <operator>=</operator> <name>angle</name> <operator>-</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt>

    <comment type="line">// Change the missle's angle so that it points toward the ship.</comment>

    <expr_stmt><expr><name><name>missle</name><operator>.</operator><name>deltaX</name></name> <operator>=</operator> <literal type="number">0.75</literal> <operator>*</operator> <name>MAX_ROCK_SPEED</name> <operator>*</operator> <operator>-</operator><call><name><name>Math</name><operator>.</operator><name>sin</name></name><argument_list>(<argument><expr><name><name>missle</name><operator>.</operator><name>angle</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>missle</name><operator>.</operator><name>deltaY</name></name> <operator>=</operator> <literal type="number">0.75</literal> <operator>*</operator> <name>MAX_ROCK_SPEED</name> <operator>*</operator>  <call><name><name>Math</name><operator>.</operator><name>cos</name></name><argument_list>(<argument><expr><name><name>missle</name><operator>.</operator><name>angle</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>stopMissle</name><parameter_list>()</parameter_list> <block>{

    <expr_stmt><expr><name><name>missle</name><operator>.</operator><name>active</name></name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>missleCounter</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt>
    <if>if <condition>(<expr><name>loaded</name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><call><name><name>missleSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
    <expr_stmt><expr><name>misslePlaying</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>initAsteroids</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>, <decl><type ref="prev"/><name>j</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>s</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>double</name></type> <name>theta</name></decl>, <decl><type ref="prev"/><name>r</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>x</name></decl>, <decl><type ref="prev"/><name>y</name></decl>;</decl_stmt>

    <comment type="line">// Create random shapes, positions and movements for each asteroid.</comment>

    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_ROCKS</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control> <block>{

      <comment type="line">// Create a jagged shape for the asteroid and give it a random rotation.</comment>

      <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>shape</name> <operator>=</operator> <operator>new</operator> <call><name>Polygon</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>s</name> <operator>=</operator> <name>MIN_ROCK_SIDES</name> <operator>+</operator> <call>(<name>int</name>) <argument_list>(<argument><expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <operator>(</operator><name>MAX_ROCK_SIDES</name> <operator>-</operator> <name>MIN_ROCK_SIDES</name><operator>)</operator></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <for>for <control>(<init><expr><name>j</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>j</name> <operator>&lt;</operator> <name>s</name></expr>;</condition> <incr><expr><name>j</name> <operator>++</operator></expr></incr>)</control> <block>{
        <expr_stmt><expr><name>theta</name> <operator>=</operator> <literal type="number">2</literal> <operator>*</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>/</operator> <name>s</name> <operator>*</operator> <name>j</name></expr>;</expr_stmt>
        <expr_stmt><expr><name>r</name> <operator>=</operator> <name>MIN_ROCK_SIZE</name> <operator>+</operator> <call>(<name>int</name>) <argument_list>(<argument><expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <operator>(</operator><name>MAX_ROCK_SIZE</name> <operator>-</operator> <name>MIN_ROCK_SIZE</name><operator>)</operator></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>x</name> <operator>=</operator> <operator>(</operator><name>int</name><operator>)</operator> <operator>-</operator><call><name><name>Math</name><operator>.</operator><name>round</name></name><argument_list>(<argument><expr><name>r</name> <operator>*</operator> <call><name><name>Math</name><operator>.</operator><name>sin</name></name><argument_list>(<argument><expr><name>theta</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>y</name> <operator>=</operator> <operator>(</operator><name>int</name><operator>)</operator>  <call><name><name>Math</name><operator>.</operator><name>round</name></name><argument_list>(<argument><expr><name>r</name> <operator>*</operator> <call><name><name>Math</name><operator>.</operator><name>cos</name></name><argument_list>(<argument><expr><name>theta</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><name>x</name></expr></argument>, <argument><expr><name>y</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      }</block></for>
      <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>angle</name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaAngle</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <literal type="number">2</literal> <operator>*</operator> <name>MAX_ROCK_SPIN</name> <operator>-</operator> <name>MAX_ROCK_SPIN</name></expr>;</expr_stmt>

      <comment type="line">// Place the asteroid at one edge of the screen.</comment>

      <if>if <condition>(<expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>&lt;</operator> <literal type="number">0.5</literal></expr>)</condition><then> <block>{
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>x</name> <operator>=</operator> <operator>-</operator><name><name>AsteroidsSprite</name><operator>.</operator><name>width</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt>
        <if>if <condition>(<expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>&lt;</operator> <literal type="number">0.5</literal></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>x</name> <operator>=</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>width</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt></block></then></if>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>y</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>height</name></name></expr>;</expr_stmt>
      }</block></then>
      <else>else <block>{
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>x</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>width</name></name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>y</name> <operator>=</operator> <operator>-</operator><name><name>AsteroidsSprite</name><operator>.</operator><name>height</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt>
        <if>if <condition>(<expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>&lt;</operator> <literal type="number">0.5</literal></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>y</name> <operator>=</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>height</name></name> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt></block></then></if>
      }</block></else></if>

      <comment type="line">// Set a random motion for the asteroid.</comment>

      <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaX</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <name>asteroidsSpeed</name></expr>;</expr_stmt>
      <if>if <condition>(<expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>&lt;</operator> <literal type="number">0.5</literal></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaX</name> <operator>=</operator> <operator>-</operator><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaX</name></expr>;</expr_stmt></block></then></if>
      <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaY</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <name>asteroidsSpeed</name></expr>;</expr_stmt>
      <if>if <condition>(<expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>&lt;</operator> <literal type="number">0.5</literal></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaY</name> <operator>=</operator> <operator>-</operator><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaY</name></expr>;</expr_stmt></block></then></if>

      <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name>render</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>asteroidIsSmall</name><index>[<expr><name>i</name></expr>]</index></name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
    }</block></for>

    <expr_stmt><expr><name>asteroidsCounter</name> <operator>=</operator> <name>STORM_PAUSE</name></expr>;</expr_stmt>
    <expr_stmt><expr><name>asteroidsLeft</name> <operator>=</operator> <name>MAX_ROCKS</name></expr>;</expr_stmt>
    <if>if <condition>(<expr><name>asteroidsSpeed</name> <operator>&lt;</operator> <name>MAX_ROCK_SPEED</name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name>asteroidsSpeed</name> <operator>+=</operator> <literal type="number">0.5</literal></expr>;</expr_stmt></block></then></if>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>initSmallAsteroids</name><parameter_list>(<parameter><decl><type><name>int</name></type> <name>n</name></decl></parameter>)</parameter_list> <block>{

    <decl_stmt><decl><type><name>int</name></type> <name>count</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>, <decl><type ref="prev"/><name>j</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>s</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>double</name></type> <name>tempX</name></decl>, <decl><type ref="prev"/><name>tempY</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>double</name></type> <name>theta</name></decl>, <decl><type ref="prev"/><name>r</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>x</name></decl>, <decl><type ref="prev"/><name>y</name></decl>;</decl_stmt>

    <comment type="line">// Create one or two smaller asteroids from a larger one using inactive</comment>
    <comment type="line">// asteroids. The new asteroids will be placed in the same position as the</comment>
    <comment type="line">// old one but will have a new, smaller shape and new, randomly generated</comment>
    <comment type="line">// movements.</comment>

    <expr_stmt><expr><name>count</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name>tempX</name> <operator>=</operator> <name><name>asteroids</name><index>[<expr><name>n</name></expr>]</index></name><operator>.</operator><name>x</name></expr>;</expr_stmt>
    <expr_stmt><expr><name>tempY</name> <operator>=</operator> <name><name>asteroids</name><index>[<expr><name>n</name></expr>]</index></name><operator>.</operator><name>y</name></expr>;</expr_stmt>
    <do>do <block>{
      <if>if <condition>(<expr><operator>!</operator><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name></expr>)</condition><then> <block>{
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>shape</name> <operator>=</operator> <operator>new</operator> <call><name>Polygon</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>s</name> <operator>=</operator> <name>MIN_ROCK_SIDES</name> <operator>+</operator> <call>(<name>int</name>) <argument_list>(<argument><expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <operator>(</operator><name>MAX_ROCK_SIDES</name> <operator>-</operator> <name>MIN_ROCK_SIDES</name><operator>)</operator></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <for>for <control>(<init><expr><name>j</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>j</name> <operator>&lt;</operator> <name>s</name></expr>;</condition> <incr><expr><name>j</name> <operator>++</operator></expr></incr>)</control> <block>{
          <expr_stmt><expr><name>theta</name> <operator>=</operator> <literal type="number">2</literal> <operator>*</operator> <name><name>Math</name><operator>.</operator><name>PI</name></name> <operator>/</operator> <name>s</name> <operator>*</operator> <name>j</name></expr>;</expr_stmt>
          <expr_stmt><expr><name>r</name> <operator>=</operator> <operator>(</operator><name>MIN_ROCK_SIZE</name> <operator>+</operator> <call>(<name>int</name>) <argument_list>(<argument><expr><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <operator>(</operator><name>MAX_ROCK_SIZE</name> <operator>-</operator> <name>MIN_ROCK_SIZE</name><operator>)</operator></expr></argument>)</argument_list></call><operator>)</operator> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt>
          <expr_stmt><expr><name>x</name> <operator>=</operator> <operator>(</operator><name>int</name><operator>)</operator> <operator>-</operator><call><name><name>Math</name><operator>.</operator><name>round</name></name><argument_list>(<argument><expr><name>r</name> <operator>*</operator> <call><name><name>Math</name><operator>.</operator><name>sin</name></name><argument_list>(<argument><expr><name>theta</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><name>y</name> <operator>=</operator> <operator>(</operator><name>int</name><operator>)</operator>  <call><name><name>Math</name><operator>.</operator><name>round</name></name><argument_list>(<argument><expr><name>r</name> <operator>*</operator> <call><name><name>Math</name><operator>.</operator><name>cos</name></name><argument_list>(<argument><expr><name>theta</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(<argument><expr><name>x</name></expr></argument>, <argument><expr><name>y</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></for>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>angle</name> <operator>=</operator> <literal type="number">0.0</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaAngle</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <literal type="number">2</literal> <operator>*</operator> <name>MAX_ROCK_SPIN</name> <operator>-</operator> <name>MAX_ROCK_SPIN</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>x</name> <operator>=</operator> <name>tempX</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>y</name> <operator>=</operator> <name>tempY</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaX</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <literal type="number">2</literal> <operator>*</operator> <name>asteroidsSpeed</name> <operator>-</operator> <name>asteroidsSpeed</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>deltaY</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <literal type="number">2</literal> <operator>*</operator> <name>asteroidsSpeed</name> <operator>-</operator> <name>asteroidsSpeed</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name>render</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroidIsSmall</name><index>[<expr><name>i</name></expr>]</index></name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name>count</name><operator>++</operator></expr>;</expr_stmt>
        <expr_stmt><expr><name>asteroidsLeft</name><operator>++</operator></expr>;</expr_stmt>
      }</block></then></if>
      <expr_stmt><expr><name>i</name><operator>++</operator></expr>;</expr_stmt>
    }</block> while <condition>(<expr><name>i</name> <operator>&lt;</operator> <name>MAX_ROCKS</name> <operator>&amp;&amp;</operator> <name>count</name> <operator>&lt;</operator> <literal type="number">2</literal></expr>)</condition>;</do>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>updateAsteroids</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>, <decl><type ref="prev"/><name>j</name></decl>;</decl_stmt>

    <comment type="line">// Move any active asteroids and check for collisions.</comment>

    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_ROCKS</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
      <block type="pseudo"><if>if <condition>(<expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name></expr>)</condition><then> <block>{
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name>advance</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name>render</name><argument_list>()</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// If hit by photon, kill asteroid and advance score. If asteroid is</comment>
        <comment type="line">// large, make some smaller ones to replace it.</comment>

        <for>for <control>(<init><expr><name>j</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>j</name> <operator>&lt;</operator> <name>MAX_SHOTS</name></expr>;</condition> <incr><expr><name>j</name><operator>++</operator></expr></incr>)</control>
          <block type="pseudo"><if>if <condition>(<expr><name><name>photons</name><index>[<expr><name>j</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>&amp;&amp;</operator> <name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>&amp;&amp;</operator> <name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name>isColliding</name><argument_list>(<argument><expr><name><name>photons</name><index>[<expr><name>j</name></expr>]</index></name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
            <expr_stmt><expr><name>asteroidsLeft</name><operator>--</operator></expr>;</expr_stmt>
            <expr_stmt><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
            <expr_stmt><expr><name><name>photons</name><index>[<expr><name>j</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
            <if>if <condition>(<expr><name>sound</name></expr>)</condition><then>
              <block type="pseudo"><expr_stmt><expr><call><name><name>explosionSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
            <expr_stmt><expr><call><name>explode</name><argument_list>(<argument><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <if>if <condition>(<expr><operator>!</operator><name><name>asteroidIsSmall</name><index>[<expr><name>i</name></expr>]</index></name></expr>)</condition><then> <block>{
              <expr_stmt><expr><name>score</name> <operator>+=</operator> <name>BIG_POINTS</name></expr>;</expr_stmt>
              <expr_stmt><expr><call><name>initSmallAsteroids</name><argument_list>(<argument><expr><name>i</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            }</block></then>
            <else>else
              <block type="pseudo"><expr_stmt><expr><name>score</name> <operator>+=</operator> <name>SMALL_POINTS</name></expr>;</expr_stmt></block></else></if>
          }</block></then></if></block></for>

        <comment type="line">// If the ship is not in hyperspace, see if it is hit.</comment>

        <if>if <condition>(<expr><name><name>ship</name><operator>.</operator><name>active</name></name> <operator>&amp;&amp;</operator> <name>hyperCounter</name> <operator>&lt;=</operator> <literal type="number">0</literal> <operator>&amp;&amp;</operator>
            <name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>&amp;&amp;</operator> <name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name>isColliding</name><argument_list>(<argument><expr><name>ship</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
          <if>if <condition>(<expr><name>sound</name></expr>)</condition><then>
            <block type="pseudo"><expr_stmt><expr><call><name><name>crashSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
          <expr_stmt><expr><call><name>explode</name><argument_list>(<argument><expr><name>ship</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><call><name>stopShip</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><call><name>stopUfo</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><call><name>stopMissle</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        }</block></then></if>
    }</block></then></if></block></for>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>initExplosions</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>;</decl_stmt>

    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_SCRAP</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control> <block>{
      <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>shape</name> <operator>=</operator> <operator>new</operator> <call><name>Polygon</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>explosionCounter</name><index>[<expr><name>i</name></expr>]</index></name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt>
    }</block></for>
    <expr_stmt><expr><name>explosionIndex</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>explode</name><parameter_list>(<parameter><decl><type><name>AsteroidsSprite</name></type> <name>s</name></decl></parameter>)</parameter_list> <block>{

    <decl_stmt><decl><type><name>int</name></type> <name>c</name></decl>, <decl><type ref="prev"/><name>i</name></decl>, <decl><type ref="prev"/><name>j</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>cx</name></decl>, <decl><type ref="prev"/><name>cy</name></decl>;</decl_stmt>

    <comment type="line">// Create sprites for explosion animation. The each individual line segment</comment>
    <comment type="line">// of the given sprite is used to create a new sprite that will move</comment>
    <comment type="line">// outward  from the sprite's original position with a random rotation.</comment>

    <expr_stmt><expr><call><name><name>s</name><operator>.</operator><name>render</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><name>c</name> <operator>=</operator> <literal type="number">2</literal></expr>;</expr_stmt>
    <if>if <condition>(<expr><name>detail</name> <operator>||</operator> <name><name>s</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name> <operator>&lt;</operator> <literal type="number">6</literal></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name>c</name> <operator>=</operator> <literal type="number">1</literal></expr>;</expr_stmt></block></then></if>
    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name><name>s</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name></expr>;</condition> <incr><expr><name>i</name> <operator>+=</operator> <name>c</name></expr></incr>)</control> <block>{
      <expr_stmt><expr><name>explosionIndex</name><operator>++</operator></expr>;</expr_stmt>
      <if>if <condition>(<expr><name>explosionIndex</name> <operator>&gt;=</operator> <name>MAX_SCRAP</name></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><name>explosionIndex</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt></block></then></if>
      <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>explosionIndex</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>explosionIndex</name></expr>]</index></name><operator>.</operator><name>shape</name> <operator>=</operator> <operator>new</operator> <call><name>Polygon</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>j</name> <operator>=</operator> <name>i</name> <operator>+</operator> <literal type="number">1</literal></expr>;</expr_stmt>
      <if>if <condition>(<expr><name>j</name> <operator>&gt;=</operator> <name><name>s</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><name>j</name> <operator>-=</operator> <name><name>s</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name></expr>;</expr_stmt></block></then></if>
      <expr_stmt><expr><name>cx</name> <operator>=</operator> <call>(<name>int</name>) <argument_list>(<argument><expr><operator>(</operator><name><name>s</name><operator>.</operator><name>shape</name><operator>.</operator><name>xpoints</name><index>[<expr><name>i</name></expr>]</index></name> <operator>+</operator> <name><name>s</name><operator>.</operator><name>shape</name><operator>.</operator><name>xpoints</name><index>[<expr><name>j</name></expr>]</index></name><operator>)</operator> <operator>/</operator> <literal type="number">2</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>cy</name> <operator>=</operator> <call>(<name>int</name>) <argument_list>(<argument><expr><operator>(</operator><name><name>s</name><operator>.</operator><name>shape</name><operator>.</operator><name>ypoints</name><index>[<expr><name>i</name></expr>]</index></name> <operator>+</operator> <name><name>s</name><operator>.</operator><name>shape</name><operator>.</operator><name>ypoints</name><index>[<expr><name>j</name></expr>]</index></name><operator>)</operator> <operator>/</operator> <literal type="number">2</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>explosionIndex</name></expr>]</index></name><operator>.</operator><call><name><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(
        <argument><expr><name><name>s</name><operator>.</operator><name>shape</name><operator>.</operator><name>xpoints</name><index>[<expr><name>i</name></expr>]</index></name> <operator>-</operator> <name>cx</name></expr></argument>,
        <argument><expr><name><name>s</name><operator>.</operator><name>shape</name><operator>.</operator><name>ypoints</name><index>[<expr><name>i</name></expr>]</index></name> <operator>-</operator> <name>cy</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>explosionIndex</name></expr>]</index></name><operator>.</operator><call><name><name>shape</name><operator>.</operator><name>addPoint</name></name><argument_list>(
        <argument><expr><name><name>s</name><operator>.</operator><name>shape</name><operator>.</operator><name>xpoints</name><index>[<expr><name>j</name></expr>]</index></name> <operator>-</operator> <name>cx</name></expr></argument>,
        <argument><expr><name><name>s</name><operator>.</operator><name>shape</name><operator>.</operator><name>ypoints</name><index>[<expr><name>j</name></expr>]</index></name> <operator>-</operator> <name>cy</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>explosionIndex</name></expr>]</index></name><operator>.</operator><name>x</name> <operator>=</operator> <name><name>s</name><operator>.</operator><name>x</name></name> <operator>+</operator> <name>cx</name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>explosionIndex</name></expr>]</index></name><operator>.</operator><name>y</name> <operator>=</operator> <name><name>s</name><operator>.</operator><name>y</name></name> <operator>+</operator> <name>cy</name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>explosionIndex</name></expr>]</index></name><operator>.</operator><name>angle</name> <operator>=</operator> <name><name>s</name><operator>.</operator><name>angle</name></name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>explosionIndex</name></expr>]</index></name><operator>.</operator><name>deltaAngle</name> <operator>=</operator> <literal type="number">4</literal> <operator>*</operator> <operator>(</operator><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <literal type="number">2</literal> <operator>*</operator> <name>MAX_ROCK_SPIN</name> <operator>-</operator> <name>MAX_ROCK_SPIN</name><operator>)</operator></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>explosionIndex</name></expr>]</index></name><operator>.</operator><name>deltaX</name> <operator>=</operator> <operator>(</operator><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <literal type="number">2</literal> <operator>*</operator> <name>MAX_ROCK_SPEED</name> <operator>-</operator> <name>MAX_ROCK_SPEED</name> <operator>+</operator> <name><name>s</name><operator>.</operator><name>deltaX</name></name><operator>)</operator> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>explosionIndex</name></expr>]</index></name><operator>.</operator><name>deltaY</name> <operator>=</operator> <operator>(</operator><call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <literal type="number">2</literal> <operator>*</operator> <name>MAX_ROCK_SPEED</name> <operator>-</operator> <name>MAX_ROCK_SPEED</name> <operator>+</operator> <name><name>s</name><operator>.</operator><name>deltaY</name></name><operator>)</operator> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>explosionCounter</name><index>[<expr><name>explosionIndex</name></expr>]</index></name> <operator>=</operator> <name>SCRAP_COUNT</name></expr>;</expr_stmt>
    }</block></for>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>updateExplosions</name><parameter_list>()</parameter_list> <block>{

    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>;</decl_stmt>

    <comment type="line">// Move any active explosion debris. Stop explosion when its counter has</comment>
    <comment type="line">// expired.</comment>

    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_SCRAP</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
      <block type="pseudo"><if>if <condition>(<expr><name><name>explosions</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name></expr>)</condition><then> <block>{
        <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name>advance</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>explosions</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><call><name>render</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <if>if <condition>(<expr><operator>--</operator><name><name>explosionCounter</name><index>[<expr><name>i</name></expr>]</index></name> <operator>&lt;</operator> <literal type="number">0</literal></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><name><name>explosions</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt></block></then></if>
      }</block></then></if></block></for>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>keyPressed</name><parameter_list>(<parameter><decl><type><name>KeyEvent</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{

    <decl_stmt><decl><type><name>char</name></type> <name>c</name></decl>;</decl_stmt>

    <comment type="line">// Check if any cursor keys have been pressed and set flags.</comment>

    <if>if <condition>(<expr><call><name><name>e</name><operator>.</operator><name>getKeyCode</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>KeyEvent</name><operator>.</operator><name>VK_LEFT</name></name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name>left</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt></block></then></if>
    <if>if <condition>(<expr><call><name><name>e</name><operator>.</operator><name>getKeyCode</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>KeyEvent</name><operator>.</operator><name>VK_RIGHT</name></name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name>right</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt></block></then></if>
    <if>if <condition>(<expr><call><name><name>e</name><operator>.</operator><name>getKeyCode</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>KeyEvent</name><operator>.</operator><name>VK_UP</name></name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name>up</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt></block></then></if>
    <if>if <condition>(<expr><call><name><name>e</name><operator>.</operator><name>getKeyCode</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>KeyEvent</name><operator>.</operator><name>VK_DOWN</name></name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name>down</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt></block></then></if>

    <if>if <condition>(<expr><operator>(</operator><name>up</name> <operator>||</operator> <name>down</name><operator>)</operator> <operator>&amp;&amp;</operator> <name><name>ship</name><operator>.</operator><name>active</name></name> <operator>&amp;&amp;</operator> <operator>!</operator><name>thrustersPlaying</name></expr>)</condition><then> <block>{
      <if>if <condition>(<expr><name>sound</name> <operator>&amp;&amp;</operator> <operator>!</operator><name>paused</name></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><call><name><name>thrustersSound</name><operator>.</operator><name>loop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
      <expr_stmt><expr><name>thrustersPlaying</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
    }</block></then></if>

    <comment type="line">// Spacebar: fire a photon and start its counter.</comment>

    <if>if <condition>(<expr><call><name><name>e</name><operator>.</operator><name>getKeyChar</name></name><argument_list>()</argument_list></call> <operator>==</operator> <literal type="char">' '</literal> <operator>&amp;&amp;</operator> <name><name>ship</name><operator>.</operator><name>active</name></name></expr>)</condition><then> <block>{
      <if>if <condition>(<expr><name>sound</name> <operator>&amp;</operator> <operator>!</operator><name>paused</name></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><call><name><name>fireSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
      <expr_stmt><expr><name>photonTime</name> <operator>=</operator> <call><name><name>System</name><operator>.</operator><name>currentTimeMillis</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>photonIndex</name><operator>++</operator></expr>;</expr_stmt>
      <if>if <condition>(<expr><name>photonIndex</name> <operator>&gt;=</operator> <name>MAX_SHOTS</name></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><name>photonIndex</name> <operator>=</operator> <literal type="number">0</literal></expr>;</expr_stmt></block></then></if>
      <expr_stmt><expr><name><name>photons</name><index>[<expr><name>photonIndex</name></expr>]</index></name><operator>.</operator><name>active</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>photons</name><index>[<expr><name>photonIndex</name></expr>]</index></name><operator>.</operator><name>x</name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>x</name></name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>photons</name><index>[<expr><name>photonIndex</name></expr>]</index></name><operator>.</operator><name>y</name> <operator>=</operator> <name><name>ship</name><operator>.</operator><name>y</name></name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>photons</name><index>[<expr><name>photonIndex</name></expr>]</index></name><operator>.</operator><name>deltaX</name> <operator>=</operator> <literal type="number">2</literal> <operator>*</operator> <name>MAX_ROCK_SPEED</name> <operator>*</operator> <operator>-</operator><call><name><name>Math</name><operator>.</operator><name>sin</name></name><argument_list>(<argument><expr><name><name>ship</name><operator>.</operator><name>angle</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>photons</name><index>[<expr><name>photonIndex</name></expr>]</index></name><operator>.</operator><name>deltaY</name> <operator>=</operator> <literal type="number">2</literal> <operator>*</operator> <name>MAX_ROCK_SPEED</name> <operator>*</operator>  <call><name><name>Math</name><operator>.</operator><name>cos</name></name><argument_list>(<argument><expr><name><name>ship</name><operator>.</operator><name>angle</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    }</block></then></if>

    <comment type="line">// Allow upper or lower case characters for remaining keys.</comment>

    <expr_stmt><expr><name>c</name> <operator>=</operator> <call><name><name>Character</name><operator>.</operator><name>toLowerCase</name></name><argument_list>(<argument><expr><call><name><name>e</name><operator>.</operator><name>getKeyChar</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <comment type="line">// 'H' key: warp ship into hyperspace by moving to a random location and</comment>
    <comment type="line">// starting counter.</comment>

    <if>if <condition>(<expr><name>c</name> <operator>==</operator> <literal type="char">'h'</literal> <operator>&amp;&amp;</operator> <name><name>ship</name><operator>.</operator><name>active</name></name> <operator>&amp;&amp;</operator> <name>hyperCounter</name> <operator>&lt;=</operator> <literal type="number">0</literal></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>x</name></name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>width</name></name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>ship</name><operator>.</operator><name>y</name></name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>*</operator> <name><name>AsteroidsSprite</name><operator>.</operator><name>height</name></name></expr>;</expr_stmt>
      <expr_stmt><expr><name>hyperCounter</name> <operator>=</operator> <name>HYPER_COUNT</name></expr>;</expr_stmt>
      <if>if <condition>(<expr><name>sound</name> <operator>&amp;</operator> <operator>!</operator><name>paused</name></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><call><name><name>warpSound</name><operator>.</operator><name>play</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
    }</block></then></if>

    <comment type="line">// 'P' key: toggle pause mode and start or stop any active looping sound</comment>
    <comment type="line">// clips.</comment>

    <if>if <condition>(<expr><name>c</name> <operator>==</operator> <literal type="char">'p'</literal></expr>)</condition><then> <block>{
      <if>if <condition>(<expr><name>paused</name></expr>)</condition><then> <block>{
        <if>if <condition>(<expr><name>sound</name> <operator>&amp;&amp;</operator> <name>misslePlaying</name></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><call><name><name>missleSound</name><operator>.</operator><name>loop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
        <if>if <condition>(<expr><name>sound</name> <operator>&amp;&amp;</operator> <name>saucerPlaying</name></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><call><name><name>saucerSound</name><operator>.</operator><name>loop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
        <if>if <condition>(<expr><name>sound</name> <operator>&amp;&amp;</operator> <name>thrustersPlaying</name></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><call><name><name>thrustersSound</name><operator>.</operator><name>loop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
      }</block></then>
      <else>else <block>{
        <if>if <condition>(<expr><name>misslePlaying</name></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><call><name><name>missleSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
        <if>if <condition>(<expr><name>saucerPlaying</name></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><call><name><name>saucerSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
        <if>if <condition>(<expr><name>thrustersPlaying</name></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><call><name><name>thrustersSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
      }</block></else></if>
      <expr_stmt><expr><name>paused</name> <operator>=</operator> <operator>!</operator><name>paused</name></expr>;</expr_stmt>
    }</block></then></if>

    <comment type="line">// 'M' key: toggle sound on or off and stop any looping sound clips.</comment>

    <if>if <condition>(<expr><name>c</name> <operator>==</operator> <literal type="char">'m'</literal> <operator>&amp;&amp;</operator> <name>loaded</name></expr>)</condition><then> <block>{
      <if>if <condition>(<expr><name>sound</name></expr>)</condition><then> <block>{
        <expr_stmt><expr><call><name><name>crashSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>explosionSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>fireSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>missleSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>saucerSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>thrustersSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>warpSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      }</block></then>
      <else>else <block>{
        <if>if <condition>(<expr><name>misslePlaying</name> <operator>&amp;&amp;</operator> <operator>!</operator><name>paused</name></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><call><name><name>missleSound</name><operator>.</operator><name>loop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
        <if>if <condition>(<expr><name>saucerPlaying</name> <operator>&amp;&amp;</operator> <operator>!</operator><name>paused</name></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><call><name><name>saucerSound</name><operator>.</operator><name>loop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
        <if>if <condition>(<expr><name>thrustersPlaying</name> <operator>&amp;&amp;</operator> <operator>!</operator><name>paused</name></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><call><name><name>thrustersSound</name><operator>.</operator><name>loop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>
      }</block></else></if>
      <expr_stmt><expr><name>sound</name> <operator>=</operator> <operator>!</operator><name>sound</name></expr>;</expr_stmt>
    }</block></then></if>

    <comment type="line">// 'D' key: toggle graphics detail on or off.</comment>

    <if>if <condition>(<expr><name>c</name> <operator>==</operator> <literal type="char">'d'</literal></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name>detail</name> <operator>=</operator> <operator>!</operator><name>detail</name></expr>;</expr_stmt></block></then></if>

    <comment type="line">// 'S' key: start the game, if not already in progress.</comment>

    <if>if <condition>(<expr><name>c</name> <operator>==</operator> <literal type="char">'s'</literal> <operator>&amp;&amp;</operator> <name>loaded</name> <operator>&amp;&amp;</operator> <operator>!</operator><name>playing</name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><call><name>initGame</name><argument_list>()</argument_list></call></expr>;</expr_stmt></block></then></if>

    <comment type="line">// 'HOME' key: jump to web site (undocumented).</comment>

    <if>if <condition>(<expr><call><name><name>e</name><operator>.</operator><name>getKeyCode</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>KeyEvent</name><operator>.</operator><name>VK_HOME</name></name></expr>)</condition><then>
      <block type="pseudo"><try>try <block>{
        <expr_stmt><expr><call><name>getAppletContext</name><argument_list>()</argument_list></call><operator>.</operator><call><name>showDocument</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URL</name><argument_list>(<argument><expr><name>copyLink</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      }</block>
      <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>excp</name></decl></parameter>)</parameter_list> <block>{}</block></catch></try></block></then></if>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>keyReleased</name><parameter_list>(<parameter><decl><type><name>KeyEvent</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{

    <comment type="line">// Check if any cursor keys where released and set flags.</comment>

    <if>if <condition>(<expr><call><name><name>e</name><operator>.</operator><name>getKeyCode</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>KeyEvent</name><operator>.</operator><name>VK_LEFT</name></name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name>left</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt></block></then></if>
    <if>if <condition>(<expr><call><name><name>e</name><operator>.</operator><name>getKeyCode</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>KeyEvent</name><operator>.</operator><name>VK_RIGHT</name></name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name>right</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt></block></then></if>
    <if>if <condition>(<expr><call><name><name>e</name><operator>.</operator><name>getKeyCode</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>KeyEvent</name><operator>.</operator><name>VK_UP</name></name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name>up</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt></block></then></if>
    <if>if <condition>(<expr><call><name><name>e</name><operator>.</operator><name>getKeyCode</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>KeyEvent</name><operator>.</operator><name>VK_DOWN</name></name></expr>)</condition><then>
      <block type="pseudo"><expr_stmt><expr><name>down</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt></block></then></if>

    <if>if <condition>(<expr><operator>!</operator><name>up</name> <operator>&amp;&amp;</operator> <operator>!</operator><name>down</name> <operator>&amp;&amp;</operator> <name>thrustersPlaying</name></expr>)</condition><then> <block>{
      <expr_stmt><expr><call><name><name>thrustersSound</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>thrustersPlaying</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;</expr_stmt>
    }</block></then></if>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>keyTyped</name><parameter_list>(<parameter><decl><type><name>KeyEvent</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{}</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>update</name><parameter_list>(<parameter><decl><type><name>Graphics</name></type> <name>g</name></decl></parameter>)</parameter_list> <block>{

    <expr_stmt><expr><call><name>paint</name><argument_list>(<argument><expr><name>g</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
  }</block></function>

  <function><specifier>public</specifier> <type><name>void</name></type> <name>paint</name><parameter_list>(<parameter><decl><type><name>Graphics</name></type> <name>g</name></decl></parameter>)</parameter_list> <block>{

    <decl_stmt><decl><type><name>Dimension</name></type> <name>d</name> <init>= <expr><call><name>getSize</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>c</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>String</name></type> <name>s</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>w</name></decl>, <decl><type ref="prev"/><name>h</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>int</name></type> <name>x</name></decl>, <decl><type ref="prev"/><name>y</name></decl>;</decl_stmt>

    <comment type="line">// Create the off screen graphics context, if no good one exists.</comment>

    <if>if <condition>(<expr><name>offGraphics</name> <operator>==</operator> <literal type="null">null</literal> <operator>||</operator> <name><name>d</name><operator>.</operator><name>width</name></name> <operator>!=</operator> <name><name>offDimension</name><operator>.</operator><name>width</name></name> <operator>||</operator> <name><name>d</name><operator>.</operator><name>height</name></name> <operator>!=</operator> <name><name>offDimension</name><operator>.</operator><name>height</name></name></expr>)</condition><then> <block>{
      <expr_stmt><expr><name>offDimension</name> <operator>=</operator> <name>d</name></expr>;</expr_stmt>
      <expr_stmt><expr><name>offImage</name> <operator>=</operator> <call><name>createImage</name><argument_list>(<argument><expr><name><name>d</name><operator>.</operator><name>width</name></name></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>height</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>offGraphics</name> <operator>=</operator> <call><name><name>offImage</name><operator>.</operator><name>getGraphics</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    }</block></then></if>

    <comment type="line">// Fill in background and stars.</comment>

    <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><name><name>Color</name><operator>.</operator><name>black</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>fillRect</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>width</name></name></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>height</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <if>if <condition>(<expr><name>detail</name></expr>)</condition><then> <block>{
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><name><name>Color</name><operator>.</operator><name>white</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>numStars</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
        <block type="pseudo"><expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawLine</name></name><argument_list>(<argument><expr><name><name>stars</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>x</name></expr></argument>, <argument><expr><name><name>stars</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>y</name></expr></argument>, <argument><expr><name><name>stars</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>x</name></expr></argument>, <argument><expr><name><name>stars</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>y</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></block></for>
    }</block></then></if>

    <comment type="line">// Draw photon bullets.</comment>

    <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><name><name>Color</name><operator>.</operator><name>white</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_SHOTS</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
      <block type="pseudo"><if>if <condition>(<expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name></expr>)</condition><then>
        <block type="pseudo"><expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawPolygon</name></name><argument_list>(<argument><expr><name><name>photons</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>sprite</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></block></then></if></block></for>

    <comment type="line">// Draw the guided missle, counter is used to quickly fade color to black</comment>
    <comment type="line">// when near expiration.</comment>

    <expr_stmt><expr><name>c</name> <operator>=</operator> <call><name><name>Math</name><operator>.</operator><name>min</name></name><argument_list>(<argument><expr><name>missleCounter</name> <operator>*</operator> <literal type="number">24</literal></expr></argument>, <argument><expr><literal type="number">255</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Color</name><argument_list>(<argument><expr><name>c</name></expr></argument>, <argument><expr><name>c</name></expr></argument>, <argument><expr><name>c</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <if>if <condition>(<expr><name><name>missle</name><operator>.</operator><name>active</name></name></expr>)</condition><then> <block>{
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawPolygon</name></name><argument_list>(<argument><expr><name><name>missle</name><operator>.</operator><name>sprite</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawLine</name></name><argument_list>(<argument><expr><name><name>missle</name><operator>.</operator><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><name><name>missle</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name> <operator>-</operator> <literal type="number">1</literal></expr>]</index></name></expr></argument>, <argument><expr><name><name>missle</name><operator>.</operator><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><name><name>missle</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name> <operator>-</operator> <literal type="number">1</literal></expr>]</index></name></expr></argument>,
                           <argument><expr><name><name>missle</name><operator>.</operator><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><literal type="number">0</literal></expr>]</index></name></expr></argument>, <argument><expr><name><name>missle</name><operator>.</operator><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><literal type="number">0</literal></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    }</block></then></if>

    <comment type="line">// Draw the asteroids.</comment>

    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_ROCKS</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
      <block type="pseudo"><if>if <condition>(<expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name></expr>)</condition><then> <block>{
        <if>if <condition>(<expr><name>detail</name></expr>)</condition><then> <block>{
          <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><name><name>Color</name><operator>.</operator><name>black</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>fillPolygon</name></name><argument_list>(<argument><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>sprite</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></then></if>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><name><name>Color</name><operator>.</operator><name>white</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawPolygon</name></name><argument_list>(<argument><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>sprite</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawLine</name></name><argument_list>(<argument><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name><name>sprite</name><operator>.</operator><name>npoints</name></name> <operator>-</operator> <literal type="number">1</literal></expr>]</index></name></expr></argument>, <argument><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name><name>sprite</name><operator>.</operator><name>npoints</name></name> <operator>-</operator> <literal type="number">1</literal></expr>]</index></name></expr></argument>,
                             <argument><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><literal type="number">0</literal></expr>]</index></name></expr></argument>, <argument><expr><name><name>asteroids</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><literal type="number">0</literal></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      }</block></then></if></block></for>

    <comment type="line">// Draw the flying saucer.</comment>

    <if>if <condition>(<expr><name><name>ufo</name><operator>.</operator><name>active</name></name></expr>)</condition><then> <block>{
      <if>if <condition>(<expr><name>detail</name></expr>)</condition><then> <block>{
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><name><name>Color</name><operator>.</operator><name>black</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>fillPolygon</name></name><argument_list>(<argument><expr><name><name>ufo</name><operator>.</operator><name>sprite</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      }</block></then></if>
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><name><name>Color</name><operator>.</operator><name>white</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawPolygon</name></name><argument_list>(<argument><expr><name><name>ufo</name><operator>.</operator><name>sprite</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawLine</name></name><argument_list>(<argument><expr><name><name>ufo</name><operator>.</operator><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><name><name>ufo</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name> <operator>-</operator> <literal type="number">1</literal></expr>]</index></name></expr></argument>, <argument><expr><name><name>ufo</name><operator>.</operator><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><name><name>ufo</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name> <operator>-</operator> <literal type="number">1</literal></expr>]</index></name></expr></argument>,
                           <argument><expr><name><name>ufo</name><operator>.</operator><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><literal type="number">0</literal></expr>]</index></name></expr></argument>, <argument><expr><name><name>ufo</name><operator>.</operator><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><literal type="number">0</literal></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    }</block></then></if>

    <comment type="line">// Draw the ship, counter is used to fade color to white on hyperspace.</comment>

    <expr_stmt><expr><name>c</name> <operator>=</operator> <literal type="number">255</literal> <operator>-</operator> <operator>(</operator><literal type="number">255</literal> <operator>/</operator> <name>HYPER_COUNT</name><operator>)</operator> <operator>*</operator> <name>hyperCounter</name></expr>;</expr_stmt>
    <if>if <condition>(<expr><name><name>ship</name><operator>.</operator><name>active</name></name></expr>)</condition><then> <block>{
      <if>if <condition>(<expr><name>detail</name> <operator>&amp;&amp;</operator> <name>hyperCounter</name> <operator>==</operator> <literal type="number">0</literal></expr>)</condition><then> <block>{
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><name><name>Color</name><operator>.</operator><name>black</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>fillPolygon</name></name><argument_list>(<argument><expr><name><name>ship</name><operator>.</operator><name>sprite</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      }</block></then></if>
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Color</name><argument_list>(<argument><expr><name>c</name></expr></argument>, <argument><expr><name>c</name></expr></argument>, <argument><expr><name>c</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawPolygon</name></name><argument_list>(<argument><expr><name><name>ship</name><operator>.</operator><name>sprite</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawLine</name></name><argument_list>(<argument><expr><name><name>ship</name><operator>.</operator><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><name><name>ship</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name> <operator>-</operator> <literal type="number">1</literal></expr>]</index></name></expr></argument>, <argument><expr><name><name>ship</name><operator>.</operator><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><name><name>ship</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name> <operator>-</operator> <literal type="number">1</literal></expr>]</index></name></expr></argument>,
                           <argument><expr><name><name>ship</name><operator>.</operator><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><literal type="number">0</literal></expr>]</index></name></expr></argument>, <argument><expr><name><name>ship</name><operator>.</operator><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><literal type="number">0</literal></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

      <comment type="line">// Draw thruster exhaust if thrusters are on. Do it randomly to get a</comment>
      <comment type="line">// flicker effect.</comment>

      <if>if <condition>(<expr><operator>!</operator><name>paused</name> <operator>&amp;&amp;</operator> <name>detail</name> <operator>&amp;&amp;</operator> <call><name><name>Math</name><operator>.</operator><name>random</name></name><argument_list>()</argument_list></call> <operator>&lt;</operator> <literal type="number">0.5</literal></expr>)</condition><then> <block>{
        <if>if <condition>(<expr><name>up</name></expr>)</condition><then> <block>{
          <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawPolygon</name></name><argument_list>(<argument><expr><name><name>fwdThruster</name><operator>.</operator><name>sprite</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawLine</name></name><argument_list>(<argument><expr><name><name>fwdThruster</name><operator>.</operator><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><name><name>fwdThruster</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name> <operator>-</operator> <literal type="number">1</literal></expr>]</index></name></expr></argument>, <argument><expr><name><name>fwdThruster</name><operator>.</operator><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><name><name>fwdThruster</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name> <operator>-</operator> <literal type="number">1</literal></expr>]</index></name></expr></argument>,
                               <argument><expr><name><name>fwdThruster</name><operator>.</operator><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><literal type="number">0</literal></expr>]</index></name></expr></argument>, <argument><expr><name><name>fwdThruster</name><operator>.</operator><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><literal type="number">0</literal></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></then></if>
        <if>if <condition>(<expr><name>down</name></expr>)</condition><then> <block>{
          <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawPolygon</name></name><argument_list>(<argument><expr><name><name>revThruster</name><operator>.</operator><name>sprite</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawLine</name></name><argument_list>(<argument><expr><name><name>revThruster</name><operator>.</operator><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><name><name>revThruster</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name> <operator>-</operator> <literal type="number">1</literal></expr>]</index></name></expr></argument>, <argument><expr><name><name>revThruster</name><operator>.</operator><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><name><name>revThruster</name><operator>.</operator><name>sprite</name><operator>.</operator><name>npoints</name></name> <operator>-</operator> <literal type="number">1</literal></expr>]</index></name></expr></argument>,
                               <argument><expr><name><name>revThruster</name><operator>.</operator><name>sprite</name><operator>.</operator><name>xpoints</name><index>[<expr><literal type="number">0</literal></expr>]</index></name></expr></argument>, <argument><expr><name><name>revThruster</name><operator>.</operator><name>sprite</name><operator>.</operator><name>ypoints</name><index>[<expr><literal type="number">0</literal></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        }</block></then></if>
      }</block></then></if>
    }</block></then></if>

    <comment type="line">// Draw any explosion debris, counters are used to fade color to black.</comment>

    <for>for <control>(<init><expr><name>i</name> <operator>=</operator> <literal type="number">0</literal></expr>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <name>MAX_SCRAP</name></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control>
      <block type="pseudo"><if>if <condition>(<expr><name><name>explosions</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>active</name></expr>)</condition><then> <block>{
        <expr_stmt><expr><name>c</name> <operator>=</operator> <operator>(</operator><literal type="number">255</literal> <operator>/</operator> <name>SCRAP_COUNT</name><operator>)</operator> <operator>*</operator> <name><name>explosionCounter</name> <index>[<expr><name>i</name></expr>]</index></name></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Color</name><argument_list>(<argument><expr><name>c</name></expr></argument>, <argument><expr><name>c</name></expr></argument>, <argument><expr><name>c</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawPolygon</name></name><argument_list>(<argument><expr><name><name>explosions</name><index>[<expr><name>i</name></expr>]</index></name><operator>.</operator><name>sprite</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      }</block></then></if></block></for>

    <comment type="line">// Display status and messages.</comment>

    <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setFont</name></name><argument_list>(<argument><expr><name>font</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><name><name>Color</name><operator>.</operator><name>white</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawString</name></name><argument_list>(<argument><expr><literal type="string">"Score: "</literal> <operator>+</operator> <name>score</name></expr></argument>, <argument><expr><name>fontWidth</name></expr></argument>, <argument><expr><name>fontHeight</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawString</name></name><argument_list>(<argument><expr><literal type="string">"Ships: "</literal> <operator>+</operator> <name>shipsLeft</name></expr></argument>, <argument><expr><name>fontWidth</name></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>height</name></name> <operator>-</operator> <name>fontHeight</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><name>s</name> <operator>=</operator> <literal type="string">"High: "</literal> <operator>+</operator> <name>highScore</name></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawString</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>width</name></name> <operator>-</operator> <operator>(</operator><name>fontWidth</name> <operator>+</operator> <call><name><name>fm</name><operator>.</operator><name>stringWidth</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>)</argument_list></call><operator>)</operator></expr></argument>, <argument><expr><name>fontHeight</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <if>if <condition>(<expr><operator>!</operator><name>sound</name></expr>)</condition><then> <block>{
      <expr_stmt><expr><name>s</name> <operator>=</operator> <literal type="string">"Mute"</literal></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawString</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>width</name></name> <operator>-</operator> <operator>(</operator><name>fontWidth</name> <operator>+</operator> <call><name><name>fm</name><operator>.</operator><name>stringWidth</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>)</argument_list></call><operator>)</operator></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>height</name></name> <operator>-</operator> <name>fontHeight</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    }</block></then></if>

    <if>if <condition>(<expr><operator>!</operator><name>playing</name></expr>)</condition><then> <block>{
      <expr_stmt><expr><name>s</name> <operator>=</operator> <name>copyName</name></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawString</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>, <argument><expr><operator>(</operator><name><name>d</name><operator>.</operator><name>width</name></name> <operator>-</operator> <call><name><name>fm</name><operator>.</operator><name>stringWidth</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>)</argument_list></call><operator>)</operator> <operator>/</operator> <literal type="number">2</literal></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>height</name></name> <operator>/</operator> <literal type="number">2</literal> <operator>-</operator> <literal type="number">2</literal> <operator>*</operator> <name>fontHeight</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>s</name> <operator>=</operator> <name>copyVers</name></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawString</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>, <argument><expr><operator>(</operator><name><name>d</name><operator>.</operator><name>width</name></name> <operator>-</operator> <call><name><name>fm</name><operator>.</operator><name>stringWidth</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>)</argument_list></call><operator>)</operator> <operator>/</operator> <literal type="number">2</literal></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>height</name></name> <operator>/</operator> <literal type="number">2</literal> <operator>-</operator> <name>fontHeight</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>s</name> <operator>=</operator> <name>copyInfo</name></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawString</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>, <argument><expr><operator>(</operator><name><name>d</name><operator>.</operator><name>width</name></name> <operator>-</operator> <call><name><name>fm</name><operator>.</operator><name>stringWidth</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>)</argument_list></call><operator>)</operator> <operator>/</operator> <literal type="number">2</literal></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>height</name></name> <operator>/</operator> <literal type="number">2</literal> <operator>+</operator> <name>fontHeight</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><name>s</name> <operator>=</operator> <name>copyLink</name></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawString</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>, <argument><expr><operator>(</operator><name><name>d</name><operator>.</operator><name>width</name></name> <operator>-</operator> <call><name><name>fm</name><operator>.</operator><name>stringWidth</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>)</argument_list></call><operator>)</operator> <operator>/</operator> <literal type="number">2</literal></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>height</name></name> <operator>/</operator> <literal type="number">2</literal> <operator>+</operator> <literal type="number">2</literal> <operator>*</operator> <name>fontHeight</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <if>if <condition>(<expr><operator>!</operator><name>loaded</name></expr>)</condition><then> <block>{
        <expr_stmt><expr><name>s</name> <operator>=</operator> <literal type="string">"Loading sounds..."</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name>w</name> <operator>=</operator> <literal type="number">4</literal> <operator>*</operator> <name>fontWidth</name> <operator>+</operator> <call><name><name>fm</name><operator>.</operator><name>stringWidth</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>h</name> <operator>=</operator> <name>fontHeight</name></expr>;</expr_stmt>
        <expr_stmt><expr><name>x</name> <operator>=</operator> <operator>(</operator><name><name>d</name><operator>.</operator><name>width</name></name> <operator>-</operator> <name>w</name><operator>)</operator> <operator>/</operator> <literal type="number">2</literal></expr>;</expr_stmt>
        <expr_stmt><expr><name>y</name> <operator>=</operator> <literal type="number">3</literal> <operator>*</operator> <name><name>d</name><operator>.</operator><name>height</name></name> <operator>/</operator> <literal type="number">4</literal> <operator>-</operator> <call><name><name>fm</name><operator>.</operator><name>getMaxAscent</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><name><name>Color</name><operator>.</operator><name>black</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>fillRect</name></name><argument_list>(<argument><expr><name>x</name></expr></argument>, <argument><expr><name>y</name></expr></argument>, <argument><expr><name>w</name></expr></argument>, <argument><expr><name>h</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><name><name>Color</name><operator>.</operator><name>gray</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <if>if <condition>(<expr><name>clipTotal</name> <operator>&gt;</operator> <literal type="number">0</literal></expr>)</condition><then>
          <block type="pseudo"><expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>fillRect</name></name><argument_list>(<argument><expr><name>x</name></expr></argument>, <argument><expr><name>y</name></expr></argument>, <argument><expr><call>(<name>int</name>) <argument_list>(<argument><expr><name>w</name> <operator>*</operator> <name>clipsLoaded</name> <operator>/</operator> <name>clipTotal</name></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><name>h</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></block></then></if>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>setColor</name></name><argument_list>(<argument><expr><name><name>Color</name><operator>.</operator><name>white</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawRect</name></name><argument_list>(<argument><expr><name>x</name></expr></argument>, <argument><expr><name>y</name></expr></argument>, <argument><expr><name>w</name></expr></argument>, <argument><expr><name>h</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawString</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>, <argument><expr><name>x</name> <operator>+</operator> <literal type="number">2</literal> <operator>*</operator> <name>fontWidth</name></expr></argument>, <argument><expr><name>y</name> <operator>+</operator> <call><name><name>fm</name><operator>.</operator><name>getMaxAscent</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      }</block></then>
      <else>else <block>{
        <expr_stmt><expr><name>s</name> <operator>=</operator> <literal type="string">"Game Over"</literal></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawString</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>, <argument><expr><operator>(</operator><name><name>d</name><operator>.</operator><name>width</name></name> <operator>-</operator> <call><name><name>fm</name><operator>.</operator><name>stringWidth</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>)</argument_list></call><operator>)</operator> <operator>/</operator> <literal type="number">2</literal></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>height</name></name> <operator>/</operator> <literal type="number">4</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>s</name> <operator>=</operator> <literal type="string">"'S' to Start"</literal></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawString</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>, <argument><expr><operator>(</operator><name><name>d</name><operator>.</operator><name>width</name></name> <operator>-</operator> <call><name><name>fm</name><operator>.</operator><name>stringWidth</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>)</argument_list></call><operator>)</operator> <operator>/</operator> <literal type="number">2</literal></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>height</name></name> <operator>/</operator> <literal type="number">4</literal> <operator>+</operator> <name>fontHeight</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      }</block></else></if>
    }</block></then>
    <elseif>else <if>if <condition>(<expr><name>paused</name></expr>)</condition><then> <block>{
      <expr_stmt><expr><name>s</name> <operator>=</operator> <literal type="string">"Game Paused"</literal></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>offGraphics</name><operator>.</operator><name>drawString</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>, <argument><expr><operator>(</operator><name><name>d</name><operator>.</operator><name>width</name></name> <operator>-</operator> <call><name><name>fm</name><operator>.</operator><name>stringWidth</name></name><argument_list>(<argument><expr><name>s</name></expr></argument>)</argument_list></call><operator>)</operator> <operator>/</operator> <literal type="number">2</literal></expr></argument>, <argument><expr><name><name>d</name><operator>.</operator><name>height</name></name> <operator>/</operator> <literal type="number">4</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    }</block></then></if></elseif></if>

    <comment type="line">// Copy the off screen buffer to the screen.</comment>

    <expr_stmt><expr><call><name><name>g</name><operator>.</operator><name>drawImage</name></name><argument_list>(<argument><expr><name>offImage</name></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><name>this</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
  }</block></function>
}</block></class>
</unit>

</unit>
